<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="SA23204186" />


<title>Intro</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Intro</h1>
<h4 class="author">SA23204186</h4>
<h4 class="date">2023/12/4</h4>



<div id="rpackage" class="section level1">
<h1>Rpackage</h1>
<p>the r function generate SBM model in r package</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>generater_model<span class="ot">&lt;-</span><span class="cf">function</span>(<span class="at">B=</span><span class="fu">matrix</span>(<span class="fu">c</span>(.<span class="dv">2</span>,.<span class="dv">3</span>,.<span class="dv">3</span>,.<span class="dv">1</span>),<span class="at">nrow =</span> <span class="dv">2</span>),<span class="at">p=</span><span class="fu">c</span>(<span class="fl">0.3</span>,<span class="fl">0.7</span>),<span class="at">n=</span><span class="dv">1000</span>){</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">nrow</span>(B)<span class="sc">!=</span><span class="fu">ncol</span>(B))</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">&quot;ERROR&quot;</span>)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>  m<span class="ot">&lt;-</span><span class="fu">nrow</span>(B)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>      <span class="cf">if</span>(B[i,j]<span class="sc">!=</span>B[j,i])</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>        <span class="fu">return</span>(<span class="st">&quot;ERROR&quot;</span>)</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>      <span class="cf">if</span>(B[i,j]<span class="sc">&lt;</span><span class="dv">0</span>)</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>        <span class="fu">return</span>(<span class="st">&quot;ERROR&quot;</span>)</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>    }</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>    </span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>  }</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>  g<span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>m, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> p)</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>  A<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">ncol =</span> n,<span class="at">nrow =</span> n)</span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)) {</span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n) {</span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a>      A[i,j]<span class="ot">&lt;-</span><span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="dv">1</span>,B[g[i],g[j]])</span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a>      A[j,i]<span class="ot">&lt;-</span>A[i,j]</span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a>    }</span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a>  }</span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a>  <span class="fu">return</span>(A)</span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a>}</span></code></pre></div>
<p>Adjacency spectral embedding and Laplacian embedding</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>ASE <span class="ot">&lt;-</span> <span class="cf">function</span>(A,d,<span class="at">lapace=</span><span class="st">&quot;FALSE&quot;</span>) {</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">nrow</span>(A)<span class="sc">!=</span><span class="fu">ncol</span>(A))</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  <span class="fu">return</span>(<span class="st">&quot;ERROR&quot;</span>)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>n<span class="ot">=</span><span class="fu">nrow</span>(A)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>    <span class="cf">if</span>(A[i,j]<span class="sc">!=</span>A[j,i])</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>      <span class="fu">return</span>(<span class="st">&quot;ERROR&quot;</span>)</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>    <span class="cf">if</span>(A[i,j]<span class="sc">&lt;</span><span class="dv">0</span>)</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>      <span class="fu">return</span>(<span class="st">&quot;ERROR&quot;</span>)</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>  }</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>  </span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>}</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>  A[i,i]<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a>}</span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="cf">if</span>(lapace<span class="sc">==</span><span class="st">&quot;TRUE&quot;</span>){</span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a>  D<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow =</span> n,<span class="at">ncol =</span> n)</span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a>    D[i,i]<span class="ot">=</span><span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="fu">sum</span>(A[,i]))</span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a>  }</span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a>  A<span class="ot">&lt;-</span>D<span class="sc">%*%</span>A<span class="sc">%*%</span>D</span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a>}</span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a>E<span class="ot">&lt;-</span><span class="fu">eigen</span>(A)</span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a>s<span class="ot">&lt;-</span>E<span class="sc">$</span>values</span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a>v<span class="ot">&lt;-</span>E<span class="sc">$</span>vectors</span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a>v1<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow =</span> n,<span class="at">ncol =</span> d)</span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>d) {</span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a>  v1[,i]<span class="ot">&lt;-</span>v[,i]<span class="sc">*</span><span class="fu">sqrt</span>(<span class="fu">abs</span>(s[i]))</span>
<span id="cb2-32"><a href="#cb2-32" tabindex="-1"></a>}</span>
<span id="cb2-33"><a href="#cb2-33" tabindex="-1"></a><span class="fu">return</span>(v1)</span>
<span id="cb2-34"><a href="#cb2-34" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="hw1" class="section level1">
<h1>HW1</h1>
<div id="problem1" class="section level2">
<h2>Problem1</h2>
<p>Write the “my.sample” function to act as the function “sample” with
replace true. </p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>my.sample<span class="ot">&lt;-</span><span class="cf">function</span>(n,A,p){<span class="do">## n numbers of times you wan to test,A the value that the random virable can take, p the probablity coressponding to A it should be as long as A,and sumed to 1.</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">sum</span>(p)<span class="sc">!=</span><span class="dv">1</span><span class="sc">||</span>(<span class="fu">length</span>(A)<span class="sc">!=</span><span class="fu">length</span>(p)))</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>    <span class="fu">return</span>(<span class="st">&quot;ERROR&quot;</span>)</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>  <span class="cf">else</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>    b<span class="ot">&lt;-</span><span class="fu">runif</span>(n)</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>    c<span class="ot">&lt;-</span><span class="fu">rep</span>(A[<span class="dv">1</span>],n)</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>    d<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {d<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>      <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p)) {</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>        d<span class="ot">=</span>d<span class="sc">+</span>p[j]</span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>        <span class="cf">if</span>(d<span class="sc">&gt;</span>b[i]){</span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>          c[i]<span class="ot">&lt;-</span>A[j]</span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>          <span class="cf">break</span></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>        }</span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>      }</span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a>    }</span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a>  <span class="fu">return</span>(c)</span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a>}</span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a><span class="do">##some examples of this function</span></span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a><span class="fu">my.sample</span>(<span class="dv">50</span>,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>),<span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.7</span>))</span></code></pre></div>
<pre><code>##  [1] 3 3 3 3 3 2 3 3 3 3 1 2 3 1 3 3 3 3 2 3 3 3 3 3 3 3 3 3 2 3 3 1 2 3 3 3 3 3
## [39] 3 2 3 3 3 3 2 3 1 1 1 3</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">my.sample</span>(<span class="dv">40</span>,letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>],<span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>,<span class="fl">0.4</span>))</span></code></pre></div>
<pre><code>##  [1] &quot;d&quot; &quot;d&quot; &quot;c&quot; &quot;b&quot; &quot;d&quot; &quot;c&quot; &quot;d&quot; &quot;a&quot; &quot;c&quot; &quot;b&quot; &quot;d&quot; &quot;b&quot; &quot;d&quot; &quot;d&quot; &quot;d&quot; &quot;b&quot; &quot;d&quot; &quot;b&quot; &quot;d&quot;
## [20] &quot;d&quot; &quot;d&quot; &quot;c&quot; &quot;c&quot; &quot;c&quot; &quot;a&quot; &quot;d&quot; &quot;d&quot; &quot;d&quot; &quot;c&quot; &quot;b&quot; &quot;d&quot; &quot;c&quot; &quot;a&quot; &quot;a&quot; &quot;b&quot; &quot;c&quot; &quot;d&quot; &quot;c&quot;
## [39] &quot;d&quot; &quot;a&quot;</code></pre>
</div>
<div id="section" class="section level2">
<h2>3.2</h2>
<p>Use the inverse transform method to generate a random sample of size
1000 from standard Laplace distribution. </p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sign</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">-</span>u)<span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">abs</span>(<span class="dv">1-2</span><span class="sc">*</span>u)) <span class="co"># F(x) = 1/2*exp(-x), 0&lt;=x&lt;=1/2,F(x)=1-1/2*exp(-x),1/2&lt;x&lt;=1</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="fu">hist</span>(x, <span class="at">prob =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>z<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">0</span>,.<span class="dv">01</span>)</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>fz<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(z)</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="fu">lines</span>(<span class="sc">-</span>z,fz)</span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="fu">lines</span>(z,fz)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-1" class="section level2">
<h2>3.7</h2>
<p>Write a function to generate a random sample of size n from the
Beta(a, b) distribution by the acceptance-rejection. method.Generate a
random sample of size 1000 from the Beta(3,2) distribution. Graph the
histogram of the sample with the theoretical Beta(3,2) density
superimposed. </p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1235</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>my.beta<span class="ot">&lt;-</span><span class="cf">function</span>(n,a,b){<span class="do">## Let g(x=1),c=beta(a,b)^(-1)</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>j<span class="ot">&lt;-</span>k<span class="ot">&lt;-</span><span class="dv">0</span>;y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="cf">while</span> (k <span class="sc">&lt;</span> n) {</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>j <span class="ot">&lt;-</span> j <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>) <span class="co">#random variate from g(.)</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="cf">if</span> (x<span class="sc">^</span>(a<span class="dv">-1</span>) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">^</span>(b<span class="dv">-1</span>) <span class="sc">&gt;</span> u) {</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co">#we accept x</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>y[k] <span class="ot">&lt;-</span> x</span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>}</span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a>}</span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a>  <span class="fu">return</span>(y)</span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" tabindex="-1"></a>}</span>
<span id="cb8-17"><a href="#cb8-17" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">my.beta</span>(<span class="dv">1000</span>,<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb8-18"><a href="#cb8-18" tabindex="-1"></a><span class="fu">hist</span>(y, <span class="at">prob =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-19"><a href="#cb8-19" tabindex="-1"></a>z<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.01</span>)</span>
<span id="cb8-20"><a href="#cb8-20" tabindex="-1"></a>fz<span class="ot">&lt;-</span><span class="fu">beta</span>(<span class="dv">3</span>,<span class="dv">2</span>)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span>(z<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>z)</span>
<span id="cb8-21"><a href="#cb8-21" tabindex="-1"></a><span class="fu">lines</span>(z,fz)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-2" class="section level2">
<h2>3.9</h2>
<p>Write a function to generate random variates from fe. (fe=3/4(1-x^2))
</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12453</span>)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>my.fe<span class="ot">&lt;-</span><span class="cf">function</span>(n){</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>  x<span class="ot">&lt;-</span><span class="fu">runif</span>(<span class="dv">3</span><span class="sc">*</span>n,<span class="at">min =</span> <span class="sc">-</span><span class="dv">1</span>,<span class="at">max =</span> <span class="dv">1</span>)</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>  y<span class="ot">&lt;-</span><span class="fu">numeric</span>(n)</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>    <span class="cf">if</span>((<span class="fu">abs</span>(x[<span class="dv">3</span><span class="sc">*</span>i])<span class="sc">&gt;</span><span class="fu">abs</span>(x[<span class="dv">3</span><span class="sc">*</span>i<span class="dv">-1</span>]))<span class="sc">&amp;&amp;</span>(<span class="fu">abs</span>(x[<span class="dv">3</span><span class="sc">*</span>i])<span class="sc">&gt;</span><span class="fu">abs</span>(x[<span class="dv">3</span><span class="sc">*</span>i<span class="dv">-2</span>])))</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>      y[i]<span class="ot">&lt;-</span>x[<span class="dv">3</span><span class="sc">*</span>i<span class="dv">-1</span>]</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>      y[i]<span class="ot">&lt;-</span>x[<span class="dv">3</span><span class="sc">*</span>i]</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>  }</span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>  <span class="fu">return</span>(y)</span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>}</span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>y<span class="ot">&lt;-</span><span class="fu">my.fe</span>(<span class="dv">10000</span>)</span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="fu">hist</span>(y, <span class="at">prob =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a>z<span class="ot">&lt;-</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.01</span>)</span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a>fz<span class="ot">&lt;-</span><span class="dv">3</span><span class="sc">/</span><span class="dv">4</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>z<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="fu">lines</span>(z,fz)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-3" class="section level2">
<h2>3.10</h2>
<p>Prove that the algorithm given in Exercise 3.9 generates variates
from the density fe. </p>
<div id="proof" class="section level3">
<h3>proof</h3>
<p>We suppose X is the random virable that generated by methods,we can
see that X is symmetric.So to prove this conclusion, we just need to
prove that |X| has the density f=3/2(1-x^2),which is equal to prove |X|
has the distribution<span class="math display">\[
F_{|X|}(x)=\frac{3}{2}(x-\frac{1}{3}x^{3}).\]</span> We consider the
probability <span class="math display">\[P(|X|\leq
x)=\frac{1}{2}P(|U|_{(1)}\leq x)+\frac{1}{2}P(|U|_{(2)}\leq x)\\
     =\frac{1}{2}(1-(1-x)^{3})+\frac{1}{2}\times 6\int_{0}^{x}y(1-y)dy\\
     =\frac{1}{2}(1-(1-x)^{3})+\frac{1}{2}(3x^{2}-2x^{3})\\
     =\frac{3}{2}(x-\frac{1}{3}x^{3}).\]</span> As X is symmetirc, so we
prove the conclusion.</p>
</div>
</div>
</div>
<div id="hw2" class="section level1">
<h1>HW2</h1>
<div id="section-4" class="section level2">
<h2>1</h2>
<p>Proof that what value <span class="math inline">\(\rho=\frac{l}{d}\)</span> should be take to
minimize the asymptotic variance of <span class="math inline">\(\hat{\pi}=\frac{2ln}{dm},m\sim
B(n,\frac{2l}{d\pi})\)</span> . </p>
<div id="answer" class="section level3">
<h3>answer</h3>
<p>We have the equation:<span class="math display">\[
\hat{\pi}=\frac{2ln}{dm},\mathrm{E}[m]=n\frac{2l}{d\pi},Var(m)=n\frac{2l}{d\pi}(1-\frac{2l}{d\pi})\]</span>so
,by using delta method ,we have <span class="math display">\[Var(\hat{\pi})\approx
(\frac{2ln}{d(\mathrm{E}[m])^{2}})^{2} Var(m)=\frac{\pi ^{2}(\pi
d-2l)}{2ln}\]</span>. So we should choose l/d=1.</p>
<p>We than use MC method to compare the variance under different
l/d. </p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>K<span class="ot">=</span><span class="dv">100</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow =</span> <span class="dv">3</span>,<span class="at">ncol =</span> K)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>l <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.8</span>,<span class="dv">1</span>)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K) {</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>     X <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="dv">0</span>,d<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>     Y <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="dv">0</span>,pi<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>    p[j,i]<span class="ot">&lt;-</span><span class="dv">2</span><span class="sc">*</span>l[j]<span class="sc">/</span>d<span class="sc">/</span><span class="fu">mean</span>(l[j]<span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sin</span>(Y)<span class="sc">&gt;</span>X)</span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>  }</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a>}</span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;l/d:&quot;</span>,l,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="st">&quot;var:&quot;</span>,<span class="fu">c</span>(<span class="fu">var</span>(p[<span class="dv">1</span>,]),<span class="fu">var</span>(p[<span class="dv">2</span>,]),<span class="fu">var</span>(p[<span class="dv">3</span>,])))</span></code></pre></div>
<pre><code>## l/d: 0.5 0.8 1 
##  var: 2.479272e-05 1.026684e-05 6.760534e-06</code></pre>
</div>
</div>
<div id="section-5" class="section level2">
<h2>5.6</h2>
<p>In Example 5.7 the control variate approach was illustrated for Monte
Carlo integration .Now consider the antithetic variate approach.Compute
<span class="math inline">\(Cov(e^{U},e^{1-U})\)</span> and <span class="math inline">\(Var(e^{U}+e^{1-U})\)</span>,where <span class="math inline">\(U\sim Uniform(0,1)\)</span>.What is the percent
reduction in variance of <span class="math inline">\(\hat{\theta}\)</span> that can be achieved using
antithetic variates (compared with simple MC)?</p>
<div id="answer-1" class="section level3">
<h3>answer</h3>
<p>We have <span class="math display">\[Cov(e^{U},e^{1-U})=\mathrm{E}[e^{U}e^{1-U}]-\mathrm{E}e^{U}\mathrm{E}e^{1-U}\\
=e-(e-1)^{2},\]</span> and <span class="math display">\[Var(e^{U}+e^{1-U})
=Var(e^{U})+Var(e^{1-U})+2Cov(e^{U},e^{1-U})\\
=e^{2}-1-2(e-1)^{2}+2e-2(e-1)^{2}\\
=4e-2-3(e-1)^{2}\\\approx 0.1565.\]</span> </p>
<p>So we can get the variance of <span class="math inline">\(\hat{\theta}\)</span> is <span class="math display">\[Var(\hat{\theta})=\frac{Var(\frac{e^{U}+e^{1-U}}{2})}{m}
\\
=\frac{4e-2-3(e-1)^{2}}{4m}\]</span>,while the simple MC method has the
variance <span class="math display">\[Var(\hat{\theta}_{Simple
MC})=\frac{Var(e^{U})}{m} \\
=\frac{2e-2-(e-1)^{2}}{2m}\]</span>.</p>
<p>So the percent reduction is <span class="math display">\[1-\frac{Var(\hat{\theta})}{Var(\hat{\theta}_{SimpleMC})}
\\
=1-\frac{4e-2-3(e-1)^{2}}{4e-4-2(e-1)^{2}}\\
=\frac{(e-1)^{2}-2}{4e-4-2(e-1)^{2}}\\\approx 0.984\]</span></p>
</div>
</div>
<div id="section-6" class="section level2">
<h2>5.7</h2>
<p>Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate θ by
the antithetic variate approach and by the simple Monte Carlo method.
Compute an empirical estimate of the percent reduction in variance using
the antithetic variate. Compare the result with the theoretical value
from Exercise 5.6.</p>
<div id="answer-2" class="section level3">
<h3>answer</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>K<span class="ot">=</span><span class="dv">100</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>n<span class="ot">=</span><span class="fl">1e5</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow =</span> <span class="dv">2</span>,<span class="at">ncol =</span> K)</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K) {</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>  U<span class="ot">&lt;-</span><span class="fu">runif</span>(n)</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>  p[<span class="dv">1</span>,i]<span class="ot">=</span><span class="fu">var</span>((<span class="fu">exp</span>(U)<span class="sc">+</span><span class="fu">exp</span>(<span class="dv">1</span><span class="sc">-</span>U))<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>  p[<span class="dv">2</span>,i]<span class="ot">=</span><span class="fu">var</span>(<span class="fu">exp</span>(U))</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>}</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;simple MC approach&quot;</span>,<span class="st">&quot;  antithetic variate approach&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,<span class="st">&quot;var:&quot;</span>,<span class="fu">c</span>(<span class="fu">mean</span>(p[<span class="dv">2</span>,])<span class="sc">/</span>n,<span class="fu">mean</span>(p[<span class="dv">1</span>,])<span class="sc">/</span>n),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## simple MC approach   antithetic variate approach 
##  var: 2.419383e-06 3.911214e-08</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;percent reduction:&quot;</span>,<span class="dv">1</span><span class="sc">-</span><span class="fu">mean</span>(p[<span class="dv">1</span>,])<span class="sc">/</span><span class="fu">mean</span>(p[<span class="dv">2</span>,]))</span></code></pre></div>
<pre><code>## percent reduction: 0.9838338</code></pre>
</div>
</div>
<div id="hw3" class="section level2">
<h2>HW3</h2>
</div>
<div id="section-7" class="section level2">
<h2>1</h2>
<p>Prove that if g is a continous function over <span class="math inline">\((a_{i},b_{i})\)</span>,then <span class="math inline">\(\frac{Var(\hat{\theta}_{S})}{Var(\hat{\theta}_{M})}\to
0\)</span>,as <span class="math inline">\(b_{i}-a_{i}\to 0\)</span>.
</p>
<div id="proof-1" class="section level3">
<h3>proof</h3>
<p>As g is continous ,we can see that,when<span class="math inline">\(\lim_{y\to 0}g(x+y)=g(x)\)</span>.So that,<span class="math display">\[\lim_{b_{i}-a_{i}\to
0}Var(g(U)|I=i)=\lim_{b_{i}-a_{i}\to 0}
\int_{a_{i}}^{b_{i}}(g(u)-\theta_{i})^{2}du\\
=\lim_{b_{i}-a_{i}\to
0}\int_{a_{i}}^{b_{i}}g(u)^{2}du-(\int_{a_{i}}^{b_{i}}g(u)du)^{2}\\
=g(a_{i})^{2}-g(a_{i})^{2}\\
=0\]</span></p>
<p>From then on ,we notice <span class="math inline">\(\theta_{M}\)</span> has nothing to do with every
<span class="math inline">\(a_{i},b_{i}\)</span>,so we get the
proof.</p>
</div>
</div>
<div id="section-8" class="section level2">
<h2>5.13</h2>
<p>Find two importance functions f1 and f2 that are supported on (1, ∞)
and are ‘close’ to g(x),Which of your two importance functions should
produce the smaller variance in estimating the integration by importance
sampling?</p>
<div id="answer-3" class="section level3">
<h3>answer</h3>
<p>We choose <span class="math inline">\(f_{1}(x)=e^{1-x}\)</span> and
<span class="math inline">\(f_{2}(x)=\frac{2e^{-\frac{(1-x)^{2}}{2}}}{\sqrt{2\pi}}\)</span>.
we find that <span class="math display">\[\lim_{x\to\infty
}\frac{\frac{g(x)}{f_{2}(x)}}{\frac{g(x)}{f_{1}(x)}}=\frac{x^{2}}{e^{x-1+0.5x^{2}}}=0\]</span>
So, we can see that f2 should produce the smaller variance in estimating
the integration by importance sampling.</p>
</div>
</div>
<div id="section-9" class="section level2">
<h2>5.14</h2>
<p>Obtain a Monte Carlo estimate of <span class="math inline">\(\int_{1}^{\infty}g(x)dx\)</span> by importance
sampling,where g is defined above.</p>
<p>We choose the importance function f2 defined above.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>n<span class="ot">=</span><span class="fl">1e5</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>A<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow =</span> <span class="dv">2</span>,<span class="at">ncol =</span> n)</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">rnorm</span>(n)</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">+</span><span class="fu">abs</span>(a)</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>theta<span class="ot">&lt;-</span>a<span class="sc">^</span>{<span class="dv">2</span>}<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span><span class="sc">*</span>a<span class="sc">^</span>{<span class="dv">2</span>})<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.5</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>a)<span class="sc">^</span>{<span class="dv">2</span>}))</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;the integration is &quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;the integration is &quot;</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(theta))</span></code></pre></div>
<pre><code>## [1] 0.4005649</code></pre>
</div>
<div id="section-10" class="section level2">
<h2>5.15</h2>
<p>Obtain the stratified importance sampling estimate in Example 5.13
and compare it with the result of Example 5.10 </p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>n<span class="ot">=</span><span class="fl">1e5</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>a<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>b<span class="ot">=</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">5</span>)</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>k<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>A<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow =</span> <span class="dv">5</span>,<span class="at">ncol =</span> <span class="dv">2000</span>)</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>  b[j]<span class="ot">=</span><span class="fu">integrate</span>(exp,<span class="at">lower =</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">*</span>j<span class="sc">/</span><span class="dv">5</span>,<span class="at">upper =</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">*</span>(j<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">5</span>)<span class="sc">$</span>value</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>  k<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>  <span class="cf">while</span> (k<span class="sc">&lt;</span><span class="dv">2001</span>) {</span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>    a<span class="ot">=</span><span class="fu">rexp</span>(<span class="dv">1</span>)</span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>    <span class="cf">if</span>((a<span class="sc">&lt;</span>j<span class="sc">/</span><span class="dv">5</span>)<span class="sc">&amp;&amp;</span>(a<span class="sc">&gt;</span>(j<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">5</span>)){</span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a>      A[j,k]<span class="ot">&lt;-</span>a</span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a>      k<span class="ot">&lt;-</span>k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a>    }</span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a>  }</span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a>}</span>
<span id="cb20-17"><a href="#cb20-17" tabindex="-1"></a></span>
<span id="cb20-18"><a href="#cb20-18" tabindex="-1"></a>Mean<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">5</span>)</span>
<span id="cb20-19"><a href="#cb20-19" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb20-20"><a href="#cb20-20" tabindex="-1"></a>  Mean[j]<span class="ot">&lt;-</span><span class="fu">mean</span>(b[j]<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>A[j,]<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb20-21"><a href="#cb20-21" tabindex="-1"></a>}</span>
<span id="cb20-22"><a href="#cb20-22" tabindex="-1"></a>Var<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">5</span>)</span>
<span id="cb20-23"><a href="#cb20-23" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) {</span>
<span id="cb20-24"><a href="#cb20-24" tabindex="-1"></a>  Var[j]<span class="ot">&lt;-</span><span class="fu">var</span>(b[j]<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>A[j,]<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb20-25"><a href="#cb20-25" tabindex="-1"></a>}</span>
<span id="cb20-26"><a href="#cb20-26" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;the integration is &quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;the integration is &quot;</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sum</span>(Mean))</span></code></pre></div>
<pre><code>## [1] 0.5247347</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;the variance of the estimate is &quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;the variance of the estimate is &quot;</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sum</span>(Var)<span class="sc">/</span><span class="dv">2000</span>)</span></code></pre></div>
<pre><code>## [1] 3.155931e-08</code></pre>
</div>
<div id="section-11" class="section level2">
<h2>6.5</h2>
<p>Use a Monte Carlo experiment to estimate the coverage probability of
the t-interval for random samples of χ2(2) data with sample size n = 20.
Compare your t-interval results with the simulation results in Example
6.4.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> .<span class="dv">05</span></span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="at">expr =</span> {</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n, <span class="at">df =</span> <span class="dv">2</span>)</span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(x)<span class="sc">+</span><span class="fu">sqrt</span>(<span class="fu">var</span>(x)<span class="sc">/</span>n)<span class="sc">*</span><span class="fu">qt</span>(alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>n<span class="dv">-1</span>,<span class="at">lower.tail =</span> <span class="cn">FALSE</span>),<span class="fu">mean</span>(x)<span class="sc">-</span><span class="fu">sqrt</span>(<span class="fu">var</span>(x)<span class="sc">/</span>n)<span class="sc">*</span><span class="fu">qt</span>(alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>n<span class="dv">-1</span>,<span class="at">lower.tail =</span> <span class="cn">FALSE</span>))</span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>} )</span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a>k<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a>  <span class="cf">if</span>(U[<span class="dv">1</span>,i]<span class="sc">&gt;</span><span class="dv">2</span><span class="sc">&amp;&amp;</span>U[<span class="dv">2</span>,i]<span class="sc">&lt;</span><span class="dv">2</span>){</span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a>    k<span class="ot">&lt;-</span>k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a>  }</span>
<span id="cb28-12"><a href="#cb28-12" tabindex="-1"></a>}</span>
<span id="cb28-13"><a href="#cb28-13" tabindex="-1"></a><span class="fu">print</span>(k<span class="sc">/</span><span class="dv">1000</span>)</span></code></pre></div>
<pre><code>## [1] 0.912</code></pre>
<p>We can see that it is more close to the situation of normal
population than that in example 6.5.</p>
</div>
<div id="a" class="section level2">
<h2>6.A</h2>
<p>Use Monte Carlo simulation to investigate whether the empirical Type
I error rate of the t-test is approximately equal to the nominal
significance level α, when the sampled population is non-normal. The
t-test is robust to mild departures from normality. Discuss the
simulation results for the cases where the sampled population is (i)
χ2(1), (ii) Uniform(0,2), and (iii) Exponential(rate=1). In each case,
test H0 : µ = µ0 vs H0 : µ = µ0, where µ0 is the mean of χ2(1),
Uniform(0,2), and Exponential(1), respectively.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;In this simulation,we choose alpha=0.05&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## In this simulation,we choose alpha=0.05</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> .<span class="dv">05</span></span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="at">expr =</span> {</span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n, <span class="at">df =</span> <span class="dv">1</span>)</span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(x)<span class="sc">+</span><span class="fu">sqrt</span>(<span class="fu">var</span>(x)<span class="sc">/</span>n)<span class="sc">*</span><span class="fu">qt</span>(alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>n<span class="dv">-1</span>,<span class="at">lower.tail =</span> <span class="cn">FALSE</span>),<span class="fu">mean</span>(x)<span class="sc">-</span><span class="fu">sqrt</span>(<span class="fu">var</span>(x)<span class="sc">/</span>n)<span class="sc">*</span><span class="fu">qt</span>(alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>n<span class="dv">-1</span>,<span class="at">lower.tail =</span> <span class="cn">FALSE</span>))</span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>} )</span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a>k<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb32-9"><a href="#cb32-9" tabindex="-1"></a>  <span class="cf">if</span>(U[<span class="dv">1</span>,i]<span class="sc">&gt;</span><span class="dv">1</span><span class="sc">&amp;&amp;</span>U[<span class="dv">2</span>,i]<span class="sc">&lt;</span><span class="dv">1</span>){</span>
<span id="cb32-10"><a href="#cb32-10" tabindex="-1"></a>    k<span class="ot">&lt;-</span>k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb32-11"><a href="#cb32-11" tabindex="-1"></a>  }</span>
<span id="cb32-12"><a href="#cb32-12" tabindex="-1"></a>}</span>
<span id="cb32-13"><a href="#cb32-13" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;The Type I error rate with χ2(1) being the sample population:&quot;</span>,<span class="dv">1</span><span class="sc">-</span>k<span class="sc">/</span><span class="dv">1000</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## The Type I error rate with χ2(1) being the sample population: 0.11</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> .<span class="dv">05</span></span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="at">expr =</span> {</span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="at">min =</span> <span class="dv">0</span>,<span class="at">max =</span> <span class="dv">2</span>)</span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(x)<span class="sc">+</span><span class="fu">sqrt</span>(<span class="fu">var</span>(x)<span class="sc">/</span>n)<span class="sc">*</span><span class="fu">qt</span>(alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>n<span class="dv">-1</span>,<span class="at">lower.tail =</span> <span class="cn">FALSE</span>),<span class="fu">mean</span>(x)<span class="sc">-</span><span class="fu">sqrt</span>(<span class="fu">var</span>(x)<span class="sc">/</span>n)<span class="sc">*</span><span class="fu">qt</span>(alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>n<span class="dv">-1</span>,<span class="at">lower.tail =</span> <span class="cn">FALSE</span>))</span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a>} )</span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a>k<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a>  <span class="cf">if</span>(U[<span class="dv">1</span>,i]<span class="sc">&gt;</span><span class="dv">1</span><span class="sc">&amp;&amp;</span>U[<span class="dv">2</span>,i]<span class="sc">&lt;</span><span class="dv">1</span>){</span>
<span id="cb34-10"><a href="#cb34-10" tabindex="-1"></a>    k<span class="ot">&lt;-</span>k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb34-11"><a href="#cb34-11" tabindex="-1"></a>  }</span>
<span id="cb34-12"><a href="#cb34-12" tabindex="-1"></a>}</span>
<span id="cb34-13"><a href="#cb34-13" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;The Type I error rate with Uniform(0,2) being the sample population:&quot;</span>,<span class="dv">1</span><span class="sc">-</span>k<span class="sc">/</span><span class="dv">1000</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## The Type I error rate with Uniform(0,2) being the sample population: 0.061</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> .<span class="dv">05</span></span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="at">expr =</span> {</span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n)</span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">mean</span>(x)<span class="sc">+</span><span class="fu">sqrt</span>(<span class="fu">var</span>(x)<span class="sc">/</span>n)<span class="sc">*</span><span class="fu">qt</span>(alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>n<span class="dv">-1</span>,<span class="at">lower.tail =</span> <span class="cn">FALSE</span>),<span class="fu">mean</span>(x)<span class="sc">-</span><span class="fu">sqrt</span>(<span class="fu">var</span>(x)<span class="sc">/</span>n)<span class="sc">*</span><span class="fu">qt</span>(alpha<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>n<span class="dv">-1</span>,<span class="at">lower.tail =</span> <span class="cn">FALSE</span>))</span>
<span id="cb36-6"><a href="#cb36-6" tabindex="-1"></a>} )</span>
<span id="cb36-7"><a href="#cb36-7" tabindex="-1"></a>k<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb36-8"><a href="#cb36-8" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb36-9"><a href="#cb36-9" tabindex="-1"></a>  <span class="cf">if</span>(U[<span class="dv">1</span>,i]<span class="sc">&gt;</span><span class="dv">1</span><span class="sc">&amp;&amp;</span>U[<span class="dv">2</span>,i]<span class="sc">&lt;</span><span class="dv">1</span>){</span>
<span id="cb36-10"><a href="#cb36-10" tabindex="-1"></a>    k<span class="ot">&lt;-</span>k<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb36-11"><a href="#cb36-11" tabindex="-1"></a>  }</span>
<span id="cb36-12"><a href="#cb36-12" tabindex="-1"></a>}</span>
<span id="cb36-13"><a href="#cb36-13" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;The Type I error rate with Exponential(1) being the sample population:&quot;</span>,<span class="dv">1</span><span class="sc">-</span>k<span class="sc">/</span><span class="dv">1000</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## The Type I error rate with Exponential(1) being the sample population: 0.071</code></pre>
<p>So,we can see that the t-test is robust to mild departures from
normality.</p>
</div>
</div>
<div id="hw4" class="section level1">
<h1>HW4</h1>
<div id="section-12" class="section level2">
<h2>1</h2>
<p>Compare B-F and B-H in m=1000 tests by computing FWER,FDR and TPR
with M=1000 simulations.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a>M<span class="ot">=</span><span class="dv">1000</span></span>
<span id="cb38-3"><a href="#cb38-3" tabindex="-1"></a>m<span class="ot">=</span><span class="dv">1000</span></span>
<span id="cb38-4"><a href="#cb38-4" tabindex="-1"></a>BF<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">ncol =</span> <span class="dv">3</span>,<span class="at">nrow =</span> M)</span>
<span id="cb38-5"><a href="#cb38-5" tabindex="-1"></a>BH<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">ncol =</span> <span class="dv">3</span>,<span class="at">nrow =</span> M)</span>
<span id="cb38-6"><a href="#cb38-6" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">numeric</span>(m<span class="sc">*</span>(<span class="dv">1</span><span class="fl">-0.05</span>))</span>
<span id="cb38-7"><a href="#cb38-7" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="fu">numeric</span>(m<span class="sc">*</span><span class="fl">0.05</span>)</span>
<span id="cb38-8"><a href="#cb38-8" tabindex="-1"></a>c<span class="ot">&lt;-</span><span class="fu">numeric</span>(m)</span>
<span id="cb38-9"><a href="#cb38-9" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M) {</span>
<span id="cb38-10"><a href="#cb38-10" tabindex="-1"></a>  a<span class="ot">&lt;-</span><span class="fu">runif</span>(m<span class="sc">*</span>(<span class="dv">1</span><span class="fl">-0.05</span>))</span>
<span id="cb38-11"><a href="#cb38-11" tabindex="-1"></a>  b<span class="ot">&lt;-</span><span class="fu">rbeta</span>(m<span class="sc">*</span><span class="fl">0.05</span>,<span class="at">shape1=</span><span class="fl">0.1</span>,<span class="at">shape2=</span><span class="dv">1</span>)</span>
<span id="cb38-12"><a href="#cb38-12" tabindex="-1"></a>  c<span class="ot">&lt;-</span><span class="fu">c</span>(a,b)</span>
<span id="cb38-13"><a href="#cb38-13" tabindex="-1"></a>  bf<span class="ot">&lt;-</span><span class="fu">p.adjust</span>(c,<span class="at">method =</span> <span class="st">&quot;bonferroni&quot;</span>)</span>
<span id="cb38-14"><a href="#cb38-14" tabindex="-1"></a>  bh<span class="ot">&lt;-</span><span class="fu">p.adjust</span>(c,<span class="at">method =</span> <span class="st">&quot;BH&quot;</span>)</span>
<span id="cb38-15"><a href="#cb38-15" tabindex="-1"></a>  BF[i,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">sum</span>(bf[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>]<span class="sc">&lt;</span><span class="fl">0.1</span>)<span class="sc">&gt;</span><span class="dv">0</span></span>
<span id="cb38-16"><a href="#cb38-16" tabindex="-1"></a>  BF[i,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">sum</span>(bf[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>]<span class="sc">&lt;</span><span class="fl">0.1</span>)<span class="sc">/</span><span class="fu">sum</span>(bf<span class="sc">&lt;</span><span class="fl">0.1</span>)</span>
<span id="cb38-17"><a href="#cb38-17" tabindex="-1"></a>  BF[i,<span class="dv">3</span>]<span class="ot">&lt;-</span><span class="fu">sum</span>(bf[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>]<span class="sc">&gt;</span><span class="fl">0.1</span>)<span class="sc">/</span><span class="dv">950</span></span>
<span id="cb38-18"><a href="#cb38-18" tabindex="-1"></a>  BH[i,<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="fu">sum</span>(bh[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>]<span class="sc">&lt;</span><span class="fl">0.1</span>)<span class="sc">&gt;</span><span class="dv">0</span></span>
<span id="cb38-19"><a href="#cb38-19" tabindex="-1"></a>  BH[i,<span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">sum</span>(bh[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>]<span class="sc">&lt;</span><span class="fl">0.1</span>)<span class="sc">/</span><span class="fu">sum</span>(bf<span class="sc">&lt;</span><span class="fl">0.1</span>)</span>
<span id="cb38-20"><a href="#cb38-20" tabindex="-1"></a>  BH[i,<span class="dv">3</span>]<span class="ot">&lt;-</span><span class="fu">sum</span>(bh[<span class="dv">1</span><span class="sc">:</span><span class="dv">950</span>]<span class="sc">&gt;</span><span class="fl">0.1</span>)<span class="sc">/</span><span class="dv">950</span></span>
<span id="cb38-21"><a href="#cb38-21" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;TYPE</span><span class="sc">\t</span><span class="st">&quot;</span>,<span class="st">&quot;FWER</span><span class="sc">\t</span><span class="st">&quot;</span>,<span class="st">&quot;FDR</span><span class="sc">\t</span><span class="st">&quot;</span>,<span class="st">&quot;TPR&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;BF </span><span class="sc">\t</span><span class="st">&quot;</span>,<span class="fu">round</span>(<span class="fu">mean</span>(BF[,<span class="dv">1</span>]),<span class="dv">3</span>),<span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>,<span class="fu">round</span>(<span class="fu">mean</span>(BF[,<span class="dv">2</span>]),<span class="dv">3</span>),<span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>,<span class="fu">round</span>(<span class="fu">mean</span>(BF[,<span class="dv">3</span>]),<span class="dv">3</span>),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;BH </span><span class="sc">\t</span><span class="st">&quot;</span>,<span class="fu">round</span>(<span class="fu">mean</span>(BH[,<span class="dv">1</span>]),<span class="dv">3</span>),<span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>,<span class="fu">round</span>(<span class="fu">mean</span>(BH[,<span class="dv">2</span>]),<span class="dv">3</span>),<span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>,<span class="fu">round</span>(<span class="fu">mean</span>(BH[,<span class="dv">3</span>]),<span class="dv">3</span>),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## TYPE  FWER    FDR     TPR 
## BF    0.097   0.005   1 
## BH    0.925   0.158   0.997</code></pre>
</div>
<div id="section-13" class="section level2">
<h2>2</h2>
<p>The theoretical bias is <span class="math inline">\(\frac{\lambda}{n-1}\)</span>,the theoretical
standard error is <span class="math inline">\(\frac{\lambda
n}{(n-1)\sqrt(n-2)}\)</span></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">20</span>)</span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a>B<span class="ot">=</span><span class="dv">1000</span></span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a>m<span class="ot">=</span><span class="dv">1000</span></span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a> MEAN<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">ncol =</span><span class="dv">3</span> ,<span class="at">nrow =</span>m )</span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a> VAR<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">ncol =</span> <span class="dv">3</span>,<span class="at">nrow =</span> m)</span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb41-7"><a href="#cb41-7" tabindex="-1"></a> </span>
<span id="cb41-8"><a href="#cb41-8" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb41-9"><a href="#cb41-9" tabindex="-1"></a>    x<span class="ot">&lt;-</span><span class="fu">rexp</span>(n[j],<span class="at">rate =</span> <span class="dv">2</span>)</span>
<span id="cb41-10"><a href="#cb41-10" tabindex="-1"></a>    lam<span class="ot">&lt;-</span><span class="fu">numeric</span>(B)</span>
<span id="cb41-11"><a href="#cb41-11" tabindex="-1"></a>    <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb41-12"><a href="#cb41-12" tabindex="-1"></a>      y<span class="ot">&lt;-</span><span class="fu">sample</span>(x,<span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb41-13"><a href="#cb41-13" tabindex="-1"></a>      lam[k]<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(y)</span>
<span id="cb41-14"><a href="#cb41-14" tabindex="-1"></a>    }</span>
<span id="cb41-15"><a href="#cb41-15" tabindex="-1"></a>    MEAN[i,j]<span class="ot">&lt;-</span><span class="fu">mean</span>(lam)<span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x)</span>
<span id="cb41-16"><a href="#cb41-16" tabindex="-1"></a>    VAR[i,j]<span class="ot">&lt;-</span><span class="fu">sqrt</span>(<span class="fu">var</span>(lam))</span>
<span id="cb41-17"><a href="#cb41-17" tabindex="-1"></a>  }</span>
<span id="cb41-18"><a href="#cb41-18" tabindex="-1"></a>}</span>
<span id="cb41-19"><a href="#cb41-19" tabindex="-1"></a>me<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">mean</span>(MEAN[,<span class="dv">1</span>]),<span class="fu">mean</span>(MEAN[,<span class="dv">2</span>]),<span class="fu">mean</span>(MEAN[,<span class="dv">3</span>]))</span>
<span id="cb41-20"><a href="#cb41-20" tabindex="-1"></a>va<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">mean</span>(VAR[,<span class="dv">1</span>]),<span class="fu">mean</span>(VAR[,<span class="dv">2</span>]),<span class="fu">mean</span>(VAR[,<span class="dv">3</span>]))</span></code></pre></div>
<p>The results are as follow.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;n&quot;</span>,<span class="st">&quot;</span><span class="sc">\t\t\t</span><span class="st">&quot;</span>,<span class="st">&quot;5&quot;</span>,<span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>,<span class="st">&quot;10&quot;</span>,<span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>,<span class="st">&quot;20&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;theoretical bias&quot;</span>,<span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>,<span class="fu">round</span>(<span class="dv">2</span><span class="sc">/</span>(n[<span class="dv">1</span>]<span class="sc">-</span><span class="dv">1</span>),<span class="dv">3</span>),<span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>,<span class="fu">round</span>(<span class="dv">2</span><span class="sc">/</span>(n[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>),<span class="dv">3</span>),<span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>,<span class="fu">round</span>(<span class="dv">2</span><span class="sc">/</span>(n[<span class="dv">3</span>]<span class="sc">-</span><span class="dv">1</span>),<span class="dv">3</span>),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb42-3"><a href="#cb42-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;bootstrap bias&quot;</span>,<span class="st">&quot;</span><span class="sc">\t\t</span><span class="st">&quot;</span>,<span class="fu">round</span>(me[<span class="dv">1</span>],<span class="dv">3</span>),<span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>,<span class="fu">round</span>(me[<span class="dv">2</span>],<span class="dv">3</span>),<span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>,<span class="fu">round</span>(me[<span class="dv">3</span>],<span class="dv">3</span>),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb42-4"><a href="#cb42-4" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;theoretical sd&quot;</span>,<span class="st">&quot;</span><span class="sc">\t\t</span><span class="st">&quot;</span>,<span class="fu">round</span>(<span class="dv">2</span><span class="sc">*</span>n[<span class="dv">1</span>]<span class="sc">/</span>((n[<span class="dv">1</span>]<span class="sc">-</span><span class="dv">1</span>)<span class="sc">*</span><span class="fu">sqrt</span>(n[<span class="dv">1</span>]<span class="sc">-</span><span class="dv">2</span>)),<span class="dv">3</span>),<span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>,<span class="fu">round</span>(<span class="dv">2</span><span class="sc">*</span>n[<span class="dv">2</span>]<span class="sc">/</span>(n[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">1</span>)<span class="sc">/</span><span class="fu">sqrt</span>(n[<span class="dv">2</span>]<span class="sc">-</span><span class="dv">2</span>),<span class="dv">3</span>),<span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>,<span class="fu">round</span>(<span class="dv">2</span><span class="sc">*</span>n[<span class="dv">3</span>]<span class="sc">/</span>(n[<span class="dv">3</span>]<span class="sc">-</span><span class="dv">1</span>)<span class="sc">/</span><span class="fu">sqrt</span>(n[<span class="dv">3</span>]<span class="sc">-</span><span class="dv">2</span>),<span class="dv">3</span>),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb42-5"><a href="#cb42-5" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;bootstrap sd&quot;</span>,<span class="st">&quot;</span><span class="sc">\t\t</span><span class="st">&quot;</span>,<span class="fu">round</span>(va[<span class="dv">1</span>],<span class="dv">3</span>),<span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>,<span class="fu">round</span>(va[<span class="dv">2</span>],<span class="dv">3</span>),<span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>,<span class="fu">round</span>(va[<span class="dv">3</span>],<span class="dv">3</span>),<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## n             5   10      20 
## theoretical bias      0.5     0.222   0.105 
## bootstrap bias        0.563   0.212   0.103 
## theoretical sd        1.443   0.786   0.496 
## bootstrap sd          1.994   0.798   0.5</code></pre>
<p>We can see that the bootstrap bias is more close to the theoretical
bias as n increase and the same to sd.</p>
</div>
<div id="section-14" class="section level2">
<h2>7.3</h2>
<p>Obtain a bootstrap t confidence interval estimate for the correlation
statistic in Example 7.2 (law data in bootstrap). </p>
<div id="answer-4" class="section level3">
<h3>answer</h3>
<p>We apply the function in example 7.12,we calculate the 0.95 bootstrap
t-interval for correlation.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a>dat1<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow =</span> <span class="dv">15</span>,<span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>) {</span>
<span id="cb44-5"><a href="#cb44-5" tabindex="-1"></a>  dat1[i,<span class="dv">1</span>]<span class="ot">&lt;-</span>law[i,<span class="dv">1</span>]</span>
<span id="cb44-6"><a href="#cb44-6" tabindex="-1"></a>  dat1[i,<span class="dv">2</span>]<span class="ot">&lt;-</span>law[i,<span class="dv">2</span>]</span>
<span id="cb44-7"><a href="#cb44-7" tabindex="-1"></a>}</span>
<span id="cb44-8"><a href="#cb44-8" tabindex="-1"></a>boot.t.ci <span class="ot">&lt;-</span></span>
<span id="cb44-9"><a href="#cb44-9" tabindex="-1"></a><span class="cf">function</span>(x, <span class="at">B =</span> <span class="dv">2000</span>, <span class="at">R =</span> <span class="dv">200</span>, <span class="at">level =</span> .<span class="dv">95</span>, statistic){</span>
<span id="cb44-10"><a href="#cb44-10" tabindex="-1"></a><span class="co">#compute the bootstrap t CI</span></span>
<span id="cb44-11"><a href="#cb44-11" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(x)</span>
<span id="cb44-12"><a href="#cb44-12" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb44-13"><a href="#cb44-13" tabindex="-1"></a>stat <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb44-14"><a href="#cb44-14" tabindex="-1"></a>se1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb44-15"><a href="#cb44-15" tabindex="-1"></a>boot.se <span class="ot">&lt;-</span> <span class="cf">function</span>(x, R, f) {</span>
<span id="cb44-16"><a href="#cb44-16" tabindex="-1"></a><span class="co">#local function to compute the bootstrap</span></span>
<span id="cb44-17"><a href="#cb44-17" tabindex="-1"></a><span class="co">#estimate of standard error for statistic f(x)</span></span>
<span id="cb44-18"><a href="#cb44-18" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(x); m <span class="ot">&lt;-</span> <span class="fu">nrow</span>(x)</span>
<span id="cb44-19"><a href="#cb44-19" tabindex="-1"></a>th <span class="ot">&lt;-</span> <span class="fu">replicate</span>(R, <span class="at">expr =</span> {</span>
<span id="cb44-20"><a href="#cb44-20" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>m, <span class="at">size =</span> m, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb44-21"><a href="#cb44-21" tabindex="-1"></a><span class="fu">f</span>(x[i, ])</span>
<span id="cb44-22"><a href="#cb44-22" tabindex="-1"></a>})</span>
<span id="cb44-23"><a href="#cb44-23" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">sd</span>(th))</span>
<span id="cb44-24"><a href="#cb44-24" tabindex="-1"></a>}</span>
<span id="cb44-25"><a href="#cb44-25" tabindex="-1"></a><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb44-26"><a href="#cb44-26" tabindex="-1"></a>j <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb44-27"><a href="#cb44-27" tabindex="-1"></a>y <span class="ot">&lt;-</span> x[j, ]</span>
<span id="cb44-28"><a href="#cb44-28" tabindex="-1"></a>stat[b] <span class="ot">&lt;-</span> <span class="fu">statistic</span>(y)</span>
<span id="cb44-29"><a href="#cb44-29" tabindex="-1"></a>se1[b] <span class="ot">&lt;-</span> <span class="fu">boot.se</span>(y, <span class="at">R =</span> R, <span class="at">f =</span> statistic)</span>
<span id="cb44-30"><a href="#cb44-30" tabindex="-1"></a>}</span>
<span id="cb44-31"><a href="#cb44-31" tabindex="-1"></a>stat00 <span class="ot">&lt;-</span> <span class="fu">statistic</span>(x)</span>
<span id="cb44-32"><a href="#cb44-32" tabindex="-1"></a>t.stats <span class="ot">&lt;-</span> (stat <span class="sc">-</span> stat00) <span class="sc">/</span> se1</span>
<span id="cb44-33"><a href="#cb44-33" tabindex="-1"></a>se00 <span class="ot">&lt;-</span> <span class="fu">sd</span>(stat)</span>
<span id="cb44-34"><a href="#cb44-34" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> level</span>
<span id="cb44-35"><a href="#cb44-35" tabindex="-1"></a></span>
<span id="cb44-36"><a href="#cb44-36" tabindex="-1"></a>Qt <span class="ot">&lt;-</span> <span class="fu">quantile</span>(t.stats, <span class="at">probs=</span><span class="fu">c</span>(alpha<span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>),<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">type =</span> <span class="dv">1</span>)</span>
<span id="cb44-37"><a href="#cb44-37" tabindex="-1"></a><span class="fu">names</span>(Qt) <span class="ot">&lt;-</span> <span class="fu">rev</span>(<span class="fu">names</span>(Qt))</span>
<span id="cb44-38"><a href="#cb44-38" tabindex="-1"></a>CI <span class="ot">&lt;-</span> <span class="fu">rev</span>(stat00 <span class="sc">-</span> Qt <span class="sc">*</span> se00)</span>
<span id="cb44-39"><a href="#cb44-39" tabindex="-1"></a>}</span>
<span id="cb44-40"><a href="#cb44-40" tabindex="-1"></a></span>
<span id="cb44-41"><a href="#cb44-41" tabindex="-1"></a></span>
<span id="cb44-42"><a href="#cb44-42" tabindex="-1"></a>stat <span class="ot">&lt;-</span> <span class="cf">function</span>(p) {</span>
<span id="cb44-43"><a href="#cb44-43" tabindex="-1"></a><span class="fu">cor</span>(p[,<span class="dv">1</span>],p[,<span class="dv">2</span>]) }</span>
<span id="cb44-44"><a href="#cb44-44" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">boot.t.ci</span>(dat1, <span class="at">statistic =</span> stat, <span class="at">B=</span><span class="dv">2000</span>, <span class="at">R=</span><span class="dv">200</span>)</span></code></pre></div>
<pre><code>## Warning in cor(p[, 1], p[, 2]): the standard deviation is zero</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a><span class="fu">print</span>(ci)</span></code></pre></div>
<pre><code>##       2.5%      97.5% 
## -0.1448207  0.9568022</code></pre>
</div>
</div>
</div>
<div id="hw5" class="section level1">
<h1>HW5</h1>
<div id="section-15" class="section level2">
<h2>7.5</h2>
<p>Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for
the mean time between failures 1/λ by the standard normal, basic,
percentile, and BCa methods. Compare the intervals and explain why they
may differ. </p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">18</span>, <span class="dv">43</span>, <span class="dv">85</span>, <span class="dv">91</span>, <span class="dv">98</span>, <span class="dv">100</span>, <span class="dv">130</span>, <span class="dv">230</span>, <span class="dv">487</span>)</span>
<span id="cb48-2"><a href="#cb48-2" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;boot&quot;</span>)</span>
<span id="cb48-3"><a href="#cb48-3" tabindex="-1"></a>ci.norm<span class="ot">&lt;-</span>ci.basic<span class="ot">&lt;-</span>ci.perc<span class="ot">&lt;-</span>ci.bca<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb48-4"><a href="#cb48-4" tabindex="-1"></a>boot.mean<span class="ot">&lt;-</span><span class="cf">function</span>(y,i) <span class="fu">mean</span>(y[i])</span>
<span id="cb48-5"><a href="#cb48-5" tabindex="-1"></a>de <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data=</span>x,<span class="at">statistic=</span>boot.mean, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb48-6"><a href="#cb48-6" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(de,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span>
<span id="cb48-7"><a href="#cb48-7" tabindex="-1"></a>ci.norm<span class="ot">&lt;-</span>ci<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>];ci.basic<span class="ot">&lt;-</span>ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb48-8"><a href="#cb48-8" tabindex="-1"></a>ci.perc<span class="ot">&lt;-</span>ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>];ci.bca<span class="ot">&lt;-</span>ci<span class="sc">$</span>bca[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span></code></pre></div>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;bootstrap interval</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;norm</span><span class="sc">\t</span><span class="st">&quot;</span>,ci.norm,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb49-3"><a href="#cb49-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;basic</span><span class="sc">\t</span><span class="st">&quot;</span>,ci.basic,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb49-4"><a href="#cb49-4" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;perc</span><span class="sc">\t</span><span class="st">&quot;</span>,ci.perc,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb49-5"><a href="#cb49-5" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;bca</span><span class="sc">\t</span><span class="st">&quot;</span>,ci.bca,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## bootstrap interval
## norm  39.61604 178.5673 
## basic     32.34604 170.327 
## perc  45.83968 183.8206 
## bca   60.03843 214.8749</code></pre>
<p>Because the data is distributed in exp(λ) not in Gauss
distribution,so the inerval may be different.</p>
</div>
<div id="section-16" class="section level2">
<h2>7.8</h2>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and
standard error of ˆθ.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;bootstrap&quot;</span>)</span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a>S<span class="ot">&lt;-</span><span class="fu">cov</span>(scor)</span>
<span id="cb51-3"><a href="#cb51-3" tabindex="-1"></a>en<span class="ot">&lt;-</span><span class="fu">eigen</span>(S)</span>
<span id="cb51-4"><a href="#cb51-4" tabindex="-1"></a>theta<span class="ot">&lt;-</span>en<span class="sc">$</span>values[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(en<span class="sc">$</span>values)</span>
<span id="cb51-5"><a href="#cb51-5" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb51-8"><a href="#cb51-8" tabindex="-1"></a>theta.hat1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb51-9"><a href="#cb51-9" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb51-10"><a href="#cb51-10" tabindex="-1"></a>  scor.jack1 <span class="ot">&lt;-</span> scor[<span class="sc">-</span>i, ]</span>
<span id="cb51-11"><a href="#cb51-11" tabindex="-1"></a>  sigma.hat1 <span class="ot">&lt;-</span> <span class="fu">cov</span>(scor.jack1)</span>
<span id="cb51-12"><a href="#cb51-12" tabindex="-1"></a>  s1 <span class="ot">&lt;-</span> <span class="fu">eigen</span>(sigma.hat1)</span>
<span id="cb51-13"><a href="#cb51-13" tabindex="-1"></a>  v1 <span class="ot">&lt;-</span> s1<span class="sc">$</span>values</span>
<span id="cb51-14"><a href="#cb51-14" tabindex="-1"></a>  theta.hat1[i] <span class="ot">&lt;-</span> v1[<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(v1)</span>
<span id="cb51-15"><a href="#cb51-15" tabindex="-1"></a>}</span>
<span id="cb51-16"><a href="#cb51-16" tabindex="-1"></a>bias.jack <span class="ot">&lt;-</span> (n<span class="dv">-1</span>)<span class="sc">*</span>(<span class="fu">mean</span>(theta.hat1)<span class="sc">-</span>theta)</span>
<span id="cb51-17"><a href="#cb51-17" tabindex="-1"></a>se.jack <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">mean</span>((theta.hat1<span class="sc">-</span>theta)<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb51-18"><a href="#cb51-18" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">round</span>(<span class="fu">c</span>(<span class="at">original =</span> theta, <span class="at">bias.jack =</span> bias.jack, <span class="at">se.jack =</span> se.jack), <span class="dv">4</span>))</span></code></pre></div>
<pre><code>##  original bias.jack   se.jack 
##    0.6191    0.0011    0.0496</code></pre>
</div>
<div id="section-17" class="section level2">
<h2>7.11</h2>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to
select the best fitting model. Use leave-two-out cross validation to
compare the models.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12346</span>)</span>
<span id="cb53-2"><a href="#cb53-2" tabindex="-1"></a>ironslag<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">&quot;ironslag.csv&quot;</span>)</span>
<span id="cb53-3"><a href="#cb53-3" tabindex="-1"></a>m<span class="ot">&lt;-</span>ironslag<span class="sc">$</span>magnetic</span>
<span id="cb53-4"><a href="#cb53-4" tabindex="-1"></a>c<span class="ot">&lt;-</span>ironslag<span class="sc">$</span>chemical</span>
<span id="cb53-5"><a href="#cb53-5" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="fu">length</span>(m)</span>
<span id="cb53-6"><a href="#cb53-6" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" tabindex="-1"></a>e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb53-8"><a href="#cb53-8" tabindex="-1"></a><span class="co"># for n-fold cross validation</span></span>
<span id="cb53-9"><a href="#cb53-9" tabindex="-1"></a><span class="co"># fit models on leave-one-out samples</span></span>
<span id="cb53-10"><a href="#cb53-10" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)) {</span>
<span id="cb53-11"><a href="#cb53-11" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n){</span>
<span id="cb53-12"><a href="#cb53-12" tabindex="-1"></a>y <span class="ot">&lt;-</span> m[<span class="sc">-</span><span class="fu">c</span>(i,j)]</span>
<span id="cb53-13"><a href="#cb53-13" tabindex="-1"></a>x <span class="ot">&lt;-</span> c[<span class="sc">-</span><span class="fu">c</span>(i,j)]</span>
<span id="cb53-14"><a href="#cb53-14" tabindex="-1"></a>J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb53-15"><a href="#cb53-15" tabindex="-1"></a>yhat11 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> c[i]</span>
<span id="cb53-16"><a href="#cb53-16" tabindex="-1"></a>e1[i<span class="sc">*</span>(i<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span>j<span class="sc">-</span>i] <span class="ot">&lt;-</span> (m[i] <span class="sc">-</span> yhat11)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb53-17"><a href="#cb53-17" tabindex="-1"></a>yhat12 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> c[j]</span>
<span id="cb53-18"><a href="#cb53-18" tabindex="-1"></a>e1[i<span class="sc">*</span>(i<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span>j<span class="sc">-</span>i] <span class="ot">&lt;-</span>e1[i<span class="sc">*</span>(i<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span>j<span class="sc">-</span>i] <span class="sc">+</span>(m[j] <span class="sc">-</span> yhat12)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb53-19"><a href="#cb53-19" tabindex="-1"></a></span>
<span id="cb53-20"><a href="#cb53-20" tabindex="-1"></a>J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb53-21"><a href="#cb53-21" tabindex="-1"></a>yhat21 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> c[i] <span class="sc">+</span></span>
<span id="cb53-22"><a href="#cb53-22" tabindex="-1"></a>J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> c[i]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb53-23"><a href="#cb53-23" tabindex="-1"></a>e2[i<span class="sc">*</span>(i<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span>j<span class="sc">-</span>i] <span class="ot">&lt;-</span> (m[i] <span class="sc">-</span> yhat21)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb53-24"><a href="#cb53-24" tabindex="-1"></a>yhat22 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> c[j] <span class="sc">+</span></span>
<span id="cb53-25"><a href="#cb53-25" tabindex="-1"></a>J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> c[j]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb53-26"><a href="#cb53-26" tabindex="-1"></a>e2[i<span class="sc">*</span>(i<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span>j<span class="sc">-</span>i] <span class="ot">&lt;-</span>e2[i<span class="sc">*</span>(i<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span>j<span class="sc">-</span>i] <span class="sc">+</span>(m[j] <span class="sc">-</span> yhat22)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb53-27"><a href="#cb53-27" tabindex="-1"></a></span>
<span id="cb53-28"><a href="#cb53-28" tabindex="-1"></a>J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x)</span>
<span id="cb53-29"><a href="#cb53-29" tabindex="-1"></a>logyhat31 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> c[i]</span>
<span id="cb53-30"><a href="#cb53-30" tabindex="-1"></a>yhat31 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat31)</span>
<span id="cb53-31"><a href="#cb53-31" tabindex="-1"></a>e3[i<span class="sc">*</span>(i<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span>j<span class="sc">-</span>i] <span class="ot">&lt;-</span> (m[i] <span class="sc">-</span> yhat31)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb53-32"><a href="#cb53-32" tabindex="-1"></a>logyhat32 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> c[j]</span>
<span id="cb53-33"><a href="#cb53-33" tabindex="-1"></a>yhat32 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat32)</span>
<span id="cb53-34"><a href="#cb53-34" tabindex="-1"></a>e3[i<span class="sc">*</span>(i<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span>j<span class="sc">-</span>i] <span class="ot">&lt;-</span> e3[i<span class="sc">*</span>(i<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span>j<span class="sc">-</span>i] <span class="sc">+</span>(m[j] <span class="sc">-</span> yhat32)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb53-35"><a href="#cb53-35" tabindex="-1"></a></span>
<span id="cb53-36"><a href="#cb53-36" tabindex="-1"></a></span>
<span id="cb53-37"><a href="#cb53-37" tabindex="-1"></a>J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> <span class="fu">log</span>(x))</span>
<span id="cb53-38"><a href="#cb53-38" tabindex="-1"></a>logyhat41 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(c[i])</span>
<span id="cb53-39"><a href="#cb53-39" tabindex="-1"></a>yhat41 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat41)</span>
<span id="cb53-40"><a href="#cb53-40" tabindex="-1"></a>e4[i<span class="sc">*</span>(i<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span>j<span class="sc">-</span>i] <span class="ot">&lt;-</span> (m[i] <span class="sc">-</span> yhat41)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb53-41"><a href="#cb53-41" tabindex="-1"></a>logyhat42 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">log</span>(c[j])</span>
<span id="cb53-42"><a href="#cb53-42" tabindex="-1"></a>yhat42 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat42)</span>
<span id="cb53-43"><a href="#cb53-43" tabindex="-1"></a>e4[i<span class="sc">*</span>(i<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span>j<span class="sc">-</span>i] <span class="ot">&lt;-</span> e4[i<span class="sc">*</span>(i<span class="dv">-1</span>)<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span>j<span class="sc">-</span>i] <span class="sc">+</span>(m[j] <span class="sc">-</span> yhat42)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb53-44"><a href="#cb53-44" tabindex="-1"></a>  }</span>
<span id="cb53-45"><a href="#cb53-45" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;model1</span><span class="sc">\t</span><span class="st">&quot;</span>,<span class="st">&quot;model2</span><span class="sc">\t</span><span class="st">&quot;</span>,<span class="st">&quot;model3</span><span class="sc">\t</span><span class="st">&quot;</span>,<span class="st">&quot;model4</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb54-2"><a href="#cb54-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">round</span>(<span class="fu">mean</span>(e1),<span class="dv">2</span>),<span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>,<span class="fu">round</span>(<span class="fu">mean</span>(e2),<span class="dv">2</span>),<span class="fu">round</span>(<span class="fu">mean</span>(e3),<span class="dv">2</span>),<span class="fu">round</span>(<span class="fu">mean</span>(e4),<span class="dv">2</span>))</span></code></pre></div>
<pre><code>## model1    model2  model3  model4
## 736.65    721.65 1109.79 1058.18</code></pre>
<p>So we choose the model2</p>
</div>
</div>
<div id="hw6" class="section level1">
<h1>HW6</h1>
<div id="section-18" class="section level2">
<h2>1</h2>
<p>Proof the Stationarity of Metropolis-Hastings sampler Algorithm in
continuous situation. ### answer</p>
<p>For the contimous situation:we have<span class="math display">\[f(r)\alpha(r,s)g(s|r)=f(r)g(s|r)min\{\frac{f(s)g(r|s)}{f(r)g(s|r)},1\}\\
=f(s)g(r|s)min\{\frac{f(r)g(s|r)}{f(s)g(r|s)},1\}\\
=f(s)g(r|s)\alpha(s,r) \]</span>.</p>
<p>If s=r,we have <span class="math display">\[f(r)1(s=r)[1-\int_{s}\alpha(r,s)g(s|r)]=f(s)1(r=s)[1-\int_{r}\alpha(s,r)g(r,s)]
\]</span>.</p>
<p>So, we have the conclusion:<span class="math display">\[K(s,r)f(r)=K(r,s)f(s) \]</span></p>
</div>
<div id="section-19" class="section level2">
<h2>8.1</h2>
<p>Implement the two-sample Cram´er-von Mises test for equal
distributions as a permutation test. Apply the test to the data in
Examples 8.1 and 8.2.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a>X<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">158</span>,<span class="dv">171</span> ,<span class="dv">193</span>, <span class="dv">199</span>, <span class="dv">230</span>, <span class="dv">243</span>, <span class="dv">248</span>, <span class="dv">248</span>, <span class="dv">250</span>, <span class="dv">267</span>, <span class="dv">271</span>, <span class="dv">316</span>, <span class="dv">327</span>, <span class="dv">329</span>)</span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a>Y<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">141</span> ,<span class="dv">148</span>, <span class="dv">169</span>, <span class="dv">181</span>, <span class="dv">203</span>, <span class="dv">213</span>, <span class="dv">229</span>, <span class="dv">244</span>, <span class="dv">257</span>, <span class="dv">260</span>, <span class="dv">271</span>, <span class="dv">309</span>)</span>
<span id="cb56-3"><a href="#cb56-3" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;twosamples&quot;</span>)</span>
<span id="cb56-4"><a href="#cb56-4" tabindex="-1"></a>out1<span class="ot">&lt;-</span><span class="fu">cvm_test</span>(X,Y)</span>
<span id="cb56-5"><a href="#cb56-5" tabindex="-1"></a><span class="fu">print</span>(out1)</span></code></pre></div>
<pre><code>## Test Stat   P-Value 
## 0.6096939 0.3985000</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a><span class="fu">summary</span>(out1)</span></code></pre></div>
<pre><code>## CVM Test 
## =========================
## Test Statistic: 0.6096939 
##        P-Value: 0.3985 
## - - - - - - - - - - - - -
##      n1      n2 n.boots 
##      14      12    2000 
## =========================
## Test stat rejection threshold for alpha = 0.05 is: 1.857554 
## Null not rejected: samples may be from same distribution</code></pre>
</div>
<div id="section-20" class="section level2">
<h2>8.3</h2>
<p>The Count 5 test for equal variances in Section 6.4 is based on the
maximum number of extreme points. Example 6.15 shows that the Count 5
criterion is not applicable for unequal sample sizes. Implement a
permutation test for equal variance based on the maximum number of
extreme points that applies when sample sizes are not necessarily
equal.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb60-2"><a href="#cb60-2" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="dv">150</span></span>
<span id="cb60-3"><a href="#cb60-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12456</span>)</span>
<span id="cb60-4"><a href="#cb60-4" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb60-5"><a href="#cb60-5" tabindex="-1"></a>c5test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, s) {</span>
<span id="cb60-6"><a href="#cb60-6" tabindex="-1"></a>X <span class="ot">&lt;-</span> x <span class="sc">-</span> <span class="fu">mean</span>(x)</span>
<span id="cb60-7"><a href="#cb60-7" tabindex="-1"></a>Y <span class="ot">&lt;-</span> y <span class="sc">-</span> <span class="fu">mean</span>(y)</span>
<span id="cb60-8"><a href="#cb60-8" tabindex="-1"></a>outx <span class="ot">&lt;-</span> <span class="fu">sum</span>(X <span class="sc">&gt;</span> <span class="fu">max</span>(Y)) <span class="sc">+</span> <span class="fu">sum</span>(X <span class="sc">&lt;</span> <span class="fu">min</span>(Y))</span>
<span id="cb60-9"><a href="#cb60-9" tabindex="-1"></a>outy <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y <span class="sc">&gt;</span> <span class="fu">max</span>(X)) <span class="sc">+</span> <span class="fu">sum</span>(Y <span class="sc">&lt;</span> <span class="fu">min</span>(X))</span>
<span id="cb60-10"><a href="#cb60-10" tabindex="-1"></a></span>
<span id="cb60-11"><a href="#cb60-11" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">as.integer</span>(<span class="fu">max</span>(<span class="fu">c</span>(outx, outy)) <span class="sc">&gt;</span> s))</span>
<span id="cb60-12"><a href="#cb60-12" tabindex="-1"></a>}</span>
<span id="cb60-13"><a href="#cb60-13" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n1)</span>
<span id="cb60-14"><a href="#cb60-14" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n2)</span>
<span id="cb60-15"><a href="#cb60-15" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="dv">5</span><span class="sc">:</span><span class="dv">15</span></span>
<span id="cb60-16"><a href="#cb60-16" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb60-17"><a href="#cb60-17" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="fu">numeric</span>(R)</span>
<span id="cb60-18"><a href="#cb60-18" tabindex="-1"></a>alphahat <span class="ot">&lt;-</span> pwr <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(s))</span>
<span id="cb60-19"><a href="#cb60-19" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(s)) {</span>
<span id="cb60-20"><a href="#cb60-20" tabindex="-1"></a>  ss1 <span class="ot">&lt;-</span> s[j]</span>
<span id="cb60-21"><a href="#cb60-21" tabindex="-1"></a>  alphahat[j] <span class="ot">&lt;-</span> <span class="fu">c5test</span>(x, y, ss1) </span>
<span id="cb60-22"><a href="#cb60-22" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb60-23"><a href="#cb60-23" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>(n1<span class="sc">+</span>n2)</span>
<span id="cb60-24"><a href="#cb60-24" tabindex="-1"></a>  n<span class="ot">&lt;-</span><span class="fu">length</span>(x)</span>
<span id="cb60-25"><a href="#cb60-25" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>R) {</span>
<span id="cb60-26"><a href="#cb60-26" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">sample</span>(K, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb60-27"><a href="#cb60-27" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> z[k]; y1 <span class="ot">&lt;-</span> z[<span class="sc">-</span>k] </span>
<span id="cb60-28"><a href="#cb60-28" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> x1 <span class="sc">-</span> <span class="fu">mean</span>(x1) </span>
<span id="cb60-29"><a href="#cb60-29" tabindex="-1"></a> </span>
<span id="cb60-30"><a href="#cb60-30" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> y1 <span class="sc">-</span> <span class="fu">mean</span>(y1)</span>
<span id="cb60-31"><a href="#cb60-31" tabindex="-1"></a>  q[i] <span class="ot">&lt;-</span> <span class="fu">c5test</span>(x1, y1, ss1)</span>
<span id="cb60-32"><a href="#cb60-32" tabindex="-1"></a> }</span>
<span id="cb60-33"><a href="#cb60-33" tabindex="-1"></a> pwr[j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">c</span>(alphahat[j], q))</span>
<span id="cb60-34"><a href="#cb60-34" tabindex="-1"></a>}</span>
<span id="cb60-35"><a href="#cb60-35" tabindex="-1"></a><span class="fu">plot</span>(s, pwr, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="hw7" class="section level1">
<h1>HW7</h1>
<div id="section-21" class="section level2">
<h2>1</h2>
<ol style="list-style-type: decimal">
<li>Consider a model P(Y = 1 | X1, X2, X3) = exp(a+b1X1+b2X2+b3X3)
1+exp(a+b1X1+b2X2+b3X3) , where X1 ∼ P(1), X2 ∼ Exp(1) and X3 ∼ B(1,
0.5). • Design a function that takes as input values N, b1, b2, b3 and
f0, and produces the output a. • Call this function, input values are N
= 10^6 , b1 = 0, b2 = 1, b3 = −1, f0 = 0.1, 0.01, 0.001, 0.0001. • Plot
− log f0 vs a.</li>
</ol>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a>fa1<span class="ot">&lt;-</span><span class="cf">function</span>(N,b1,b2,b3,f0){</span>
<span id="cb61-2"><a href="#cb61-2" tabindex="-1"></a>  an<span class="ot">&lt;-</span><span class="fu">numeric</span>(N)</span>
<span id="cb61-3"><a href="#cb61-3" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb61-4"><a href="#cb61-4" tabindex="-1"></a>    x1<span class="ot">&lt;-</span><span class="fu">rpois</span>(<span class="at">n=</span><span class="dv">1</span>,<span class="at">lambda =</span> <span class="dv">1</span>)</span>
<span id="cb61-5"><a href="#cb61-5" tabindex="-1"></a>    x2<span class="ot">&lt;-</span><span class="fu">rexp</span>(<span class="at">n=</span><span class="dv">1</span>,<span class="at">rate =</span> <span class="dv">1</span>)</span>
<span id="cb61-6"><a href="#cb61-6" tabindex="-1"></a>    x3<span class="ot">&lt;-</span><span class="fu">rbinom</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="at">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb61-7"><a href="#cb61-7" tabindex="-1"></a>    an[i]<span class="ot">&lt;-</span><span class="fu">log</span>(f0<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>f0))<span class="sc">-</span>b1<span class="sc">*</span>x1<span class="sc">-</span>b2<span class="sc">*</span>x2<span class="sc">-</span>b3<span class="sc">*</span>x3</span>
<span id="cb61-8"><a href="#cb61-8" tabindex="-1"></a>  }</span>
<span id="cb61-9"><a href="#cb61-9" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(an))</span>
<span id="cb61-10"><a href="#cb61-10" tabindex="-1"></a>  </span>
<span id="cb61-11"><a href="#cb61-11" tabindex="-1"></a>}</span>
<span id="cb61-12"><a href="#cb61-12" tabindex="-1"></a></span>
<span id="cb61-13"><a href="#cb61-13" tabindex="-1"></a>f<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.01</span>,<span class="fl">0.001</span>,<span class="fl">0.0001</span>)</span>
<span id="cb61-14"><a href="#cb61-14" tabindex="-1"></a>N<span class="ot">&lt;-</span><span class="fl">1e6</span></span>
<span id="cb61-15"><a href="#cb61-15" tabindex="-1"></a>b1<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb61-16"><a href="#cb61-16" tabindex="-1"></a>b2<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb61-17"><a href="#cb61-17" tabindex="-1"></a>b3<span class="ot">&lt;-</span><span class="sc">-</span><span class="dv">1</span></span>
<span id="cb61-18"><a href="#cb61-18" tabindex="-1"></a>s<span class="ot">&lt;-</span><span class="sc">-</span><span class="fu">log</span>(f)</span>
<span id="cb61-19"><a href="#cb61-19" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">4</span>)</span>
<span id="cb61-20"><a href="#cb61-20" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb61-21"><a href="#cb61-21" tabindex="-1"></a>  a[j]<span class="ot">&lt;-</span><span class="fu">fa1</span>(N,b1,b2,b3,f[j])</span>
<span id="cb61-22"><a href="#cb61-22" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a><span class="fu">plot</span>(s,a,<span class="at">xlab =</span> <span class="st">&quot;-logf_0&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="section-22" class="section level2">
<h2>9.4</h2>
<p>Implement a random walk Metropolis sampler for generating the
standard Laplace distribution (see Exercise 3.2). For the increment,
simulate from a normal distribution. Compare the chains generated when
different variances are used for the proposal distribution. Also,
compute the acceptance rates of each chain.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12445</span>)</span>
<span id="cb63-2"><a href="#cb63-2" tabindex="-1"></a>rw.Metropolis <span class="ot">&lt;-</span> <span class="cf">function</span>( sigma, x0, N) {</span>
<span id="cb63-3"><a href="#cb63-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb63-4"><a href="#cb63-4" tabindex="-1"></a>x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb63-5"><a href="#cb63-5" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb63-6"><a href="#cb63-6" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb63-7"><a href="#cb63-7" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb63-8"><a href="#cb63-8" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb63-9"><a href="#cb63-9" tabindex="-1"></a><span class="cf">if</span> (u[i] <span class="sc">&lt;=</span>((<span class="fl">0.5</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(y))) <span class="sc">/</span> (<span class="fl">0.5</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(x[i<span class="dv">-1</span>])))))</span>
<span id="cb63-10"><a href="#cb63-10" tabindex="-1"></a>x[i] <span class="ot">&lt;-</span> y <span class="cf">else</span> {</span>
<span id="cb63-11"><a href="#cb63-11" tabindex="-1"></a>x[i] <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb63-12"><a href="#cb63-12" tabindex="-1"></a>k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb63-13"><a href="#cb63-13" tabindex="-1"></a>}</span>
<span id="cb63-14"><a href="#cb63-14" tabindex="-1"></a>}</span>
<span id="cb63-15"><a href="#cb63-15" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x, <span class="at">k=</span>k))</span>
<span id="cb63-16"><a href="#cb63-16" tabindex="-1"></a>}</span>
<span id="cb63-17"><a href="#cb63-17" tabindex="-1"></a></span>
<span id="cb63-18"><a href="#cb63-18" tabindex="-1"></a></span>
<span id="cb63-19"><a href="#cb63-19" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb63-20"><a href="#cb63-20" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</span>
<span id="cb63-21"><a href="#cb63-21" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb63-22"><a href="#cb63-22" tabindex="-1"></a>rw1 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>( sigma[<span class="dv">1</span>], x0, N)</span>
<span id="cb63-23"><a href="#cb63-23" tabindex="-1"></a>rw2 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>( sigma[<span class="dv">2</span>], x0, N)</span>
<span id="cb63-24"><a href="#cb63-24" tabindex="-1"></a>rw3 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>( sigma[<span class="dv">3</span>], x0, N)</span>
<span id="cb63-25"><a href="#cb63-25" tabindex="-1"></a>rw4 <span class="ot">&lt;-</span> <span class="fu">rw.Metropolis</span>( sigma[<span class="dv">4</span>], x0, N)</span></code></pre></div>
<p>number of candidate points rejected</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(rw1<span class="sc">$</span>k, rw2<span class="sc">$</span>k, rw3<span class="sc">$</span>k, rw4<span class="sc">$</span>k))</span></code></pre></div>
<pre><code>## [1]   38  318  929 1788</code></pre>
<p>acceptance rates of each chain</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">-</span>rw1<span class="sc">$</span>k<span class="sc">/</span>N, <span class="dv">1</span><span class="sc">-</span>rw2<span class="sc">$</span>k<span class="sc">/</span>N,<span class="dv">1</span><span class="sc">-</span>rw3<span class="sc">$</span>k<span class="sc">/</span>N, <span class="dv">1</span><span class="sc">-</span>rw4<span class="sc">$</span>k<span class="sc">/</span>N))</span></code></pre></div>
<pre><code>## [1] 0.9810 0.8410 0.5355 0.1060</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a> <span class="co">#display 4 graphs together</span></span>
<span id="cb68-2"><a href="#cb68-2" tabindex="-1"></a>rw <span class="ot">&lt;-</span> <span class="fu">cbind</span>(rw1<span class="sc">$</span>x, rw2<span class="sc">$</span>x, rw3<span class="sc">$</span>x, rw4<span class="sc">$</span>x)</span>
<span id="cb68-3"><a href="#cb68-3" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb68-4"><a href="#cb68-4" tabindex="-1"></a><span class="fu">plot</span>(rw[,j], <span class="at">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb68-5"><a href="#cb68-5" tabindex="-1"></a><span class="at">xlab=</span><span class="fu">bquote</span>(sigma <span class="sc">==</span> .(<span class="fu">round</span>(sigma[j],<span class="dv">3</span>))),</span>
<span id="cb68-6"><a href="#cb68-6" tabindex="-1"></a><span class="at">ylab=</span><span class="st">&quot;X&quot;</span>, <span class="at">ylim=</span><span class="fu">range</span>(rw[,j]))</span>
<span id="cb68-7"><a href="#cb68-7" tabindex="-1"></a></span>
<span id="cb68-8"><a href="#cb68-8" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" tabindex="-1"></a><span class="co">#reset to default</span></span></code></pre></div>
</div>
<div id="section-23" class="section level2">
<h2>9.7</h2>
<p>Implement a Gibbs sampler to generate a bivariate normal chain (Xt,
Yt) with zero means, unit standard deviations, and correlation 0.9. Plot
the generated sample after discarding a suitable burn-in sample. Fit a
simple linear regression model Y = β0 + β1X to the sample and check the
residuals of the model for normality and constant variance.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a><span class="co">#initialize constants and parameters</span></span>
<span id="cb70-2"><a href="#cb70-2" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span> <span class="co">#length of chain</span></span>
<span id="cb70-3"><a href="#cb70-3" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#burn-in length</span></span>
<span id="cb70-4"><a href="#cb70-4" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) <span class="co">#the chain, a bivariate sample</span></span>
<span id="cb70-5"><a href="#cb70-5" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.9</span> <span class="co">#correlation</span></span>
<span id="cb70-6"><a href="#cb70-6" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb70-7"><a href="#cb70-7" tabindex="-1"></a>mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb70-8"><a href="#cb70-8" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb70-9"><a href="#cb70-9" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb70-10"><a href="#cb70-10" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma1</span>
<span id="cb70-11"><a href="#cb70-11" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma2</span>
<span id="cb70-12"><a href="#cb70-12" tabindex="-1"></a><span class="do">###### generate the chain #####</span></span>
<span id="cb70-13"><a href="#cb70-13" tabindex="-1"></a>X[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(mu1, mu2) <span class="co">#initialize</span></span>
<span id="cb70-14"><a href="#cb70-14" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb70-15"><a href="#cb70-15" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb70-16"><a href="#cb70-16" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> mu1 <span class="sc">+</span> rho <span class="sc">*</span> (x2 <span class="sc">-</span> mu2) <span class="sc">*</span> sigma1<span class="sc">/</span>sigma2</span>
<span id="cb70-17"><a href="#cb70-17" tabindex="-1"></a>X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m1, s1)</span>
<span id="cb70-18"><a href="#cb70-18" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> X[i, <span class="dv">1</span>]</span>
<span id="cb70-19"><a href="#cb70-19" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> mu2 <span class="sc">+</span> rho <span class="sc">*</span> (x1 <span class="sc">-</span> mu1) <span class="sc">*</span> sigma2<span class="sc">/</span>sigma1</span>
<span id="cb70-20"><a href="#cb70-20" tabindex="-1"></a>X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m2, s2)</span>
<span id="cb70-21"><a href="#cb70-21" tabindex="-1"></a>}</span>
<span id="cb70-22"><a href="#cb70-22" tabindex="-1"></a>b <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb70-23"><a href="#cb70-23" tabindex="-1"></a>x <span class="ot">&lt;-</span> X[b<span class="sc">:</span>N, ]</span></code></pre></div>
<p>linear regression model Y = β0 + β1X</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a>x1<span class="ot">&lt;-</span>x[,<span class="dv">1</span>]</span>
<span id="cb71-2"><a href="#cb71-2" tabindex="-1"></a>y<span class="ot">&lt;-</span>x[,<span class="dv">2</span>]</span>
<span id="cb71-3"><a href="#cb71-3" tabindex="-1"></a>model<span class="ot">&lt;-</span><span class="fu">lm</span>(y<span class="sc">~</span>x1)</span>
<span id="cb71-4"><a href="#cb71-4" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x1)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.05005 -0.29705  0.00493  0.29022  1.41139 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 2.382e-05  7.016e-03   0.003    0.997    
## x1          9.039e-01  7.069e-03 127.867   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.4433 on 3998 degrees of freedom
## Multiple R-squared:  0.8035, Adjusted R-squared:  0.8035 
## F-statistic: 1.635e+04 on 1 and 3998 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div id="section-24" class="section level2">
<h2>9.10</h2>
<p>Refer to Example 9.1. Use the Gelman-Rubin method to monitor
convergence of the chain, and run the chain until the chain has
converged approximately to the target distribution according to R &lt;ˆ
1.2. (See Exercise 9.9.) Also use the coda [212] package to check for
convergence of the chain by the Gelman-Rubin method. Hints: See the help
topics for the coda functions gelman.diag, gelman.plot, as.mcmc, and
mcmc.list.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb73-2"><a href="#cb73-2" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb73-3"><a href="#cb73-3" tabindex="-1"></a><span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb73-4"><a href="#cb73-4" tabindex="-1"></a><span class="co"># for chain in i-th row of X</span></span>
<span id="cb73-5"><a href="#cb73-5" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb73-6"><a href="#cb73-6" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb73-7"><a href="#cb73-7" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb73-8"><a href="#cb73-8" tabindex="-1"></a></span>
<span id="cb73-9"><a href="#cb73-9" tabindex="-1"></a>psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi) <span class="co">#row means</span></span>
<span id="cb73-10"><a href="#cb73-10" tabindex="-1"></a>B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means) <span class="co">#between variance est.</span></span>
<span id="cb73-11"><a href="#cb73-11" tabindex="-1"></a></span>
<span id="cb73-12"><a href="#cb73-12" tabindex="-1"></a>psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) <span class="co">#within variances</span></span>
<span id="cb73-13"><a href="#cb73-13" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w) <span class="co">#within est.</span></span>
<span id="cb73-14"><a href="#cb73-14" tabindex="-1"></a></span>
<span id="cb73-15"><a href="#cb73-15" tabindex="-1"></a>v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n) <span class="co">#upper variance est.</span></span>
<span id="cb73-16"><a href="#cb73-16" tabindex="-1"></a></span>
<span id="cb73-17"><a href="#cb73-17" tabindex="-1"></a>r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W <span class="co">#G-R statistic</span></span>
<span id="cb73-18"><a href="#cb73-18" tabindex="-1"></a></span>
<span id="cb73-19"><a href="#cb73-19" tabindex="-1"></a><span class="fu">return</span>(r.hat)</span>
<span id="cb73-20"><a href="#cb73-20" tabindex="-1"></a>}</span>
<span id="cb73-21"><a href="#cb73-21" tabindex="-1"></a></span>
<span id="cb73-22"><a href="#cb73-22" tabindex="-1"></a></span>
<span id="cb73-23"><a href="#cb73-23" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x, sigma) {</span>
<span id="cb73-24"><a href="#cb73-24" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">any</span>(x <span class="sc">&lt;</span> <span class="dv">0</span>)) <span class="fu">return</span> (<span class="dv">0</span>)</span>
<span id="cb73-25"><a href="#cb73-25" tabindex="-1"></a><span class="fu">stopifnot</span>(sigma <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb73-26"><a href="#cb73-26" tabindex="-1"></a><span class="fu">return</span>((x <span class="sc">/</span> sigma<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb73-27"><a href="#cb73-27" tabindex="-1"></a>}</span>
<span id="cb73-28"><a href="#cb73-28" tabindex="-1"></a></span>
<span id="cb73-29"><a href="#cb73-29" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co">#number of chains to generate</span></span>
<span id="cb73-30"><a href="#cb73-30" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fl">1e5</span></span>
<span id="cb73-31"><a href="#cb73-31" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>k, <span class="at">ncol=</span>m)</span>
<span id="cb73-32"><a href="#cb73-32" tabindex="-1"></a></span>
<span id="cb73-33"><a href="#cb73-33" tabindex="-1"></a><span class="cf">for</span> (l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb73-34"><a href="#cb73-34" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb73-35"><a href="#cb73-35" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb73-36"><a href="#cb73-36" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb73-37"><a href="#cb73-37" tabindex="-1"></a>x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, <span class="at">df=</span><span class="dv">1</span>)</span>
<span id="cb73-38"><a href="#cb73-38" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb73-39"><a href="#cb73-39" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(m)</span>
<span id="cb73-40"><a href="#cb73-40" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>m) {</span>
<span id="cb73-41"><a href="#cb73-41" tabindex="-1"></a>xt <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb73-42"><a href="#cb73-42" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, <span class="at">df =</span> xt)</span>
<span id="cb73-43"><a href="#cb73-43" tabindex="-1"></a>num <span class="ot">&lt;-</span> <span class="fu">f</span>(y, sigma) <span class="sc">*</span> <span class="fu">dchisq</span>(xt, <span class="at">df =</span> y)</span>
<span id="cb73-44"><a href="#cb73-44" tabindex="-1"></a>den <span class="ot">&lt;-</span> <span class="fu">f</span>(xt, sigma) <span class="sc">*</span> <span class="fu">dchisq</span>(y, <span class="at">df =</span> xt)</span>
<span id="cb73-45"><a href="#cb73-45" tabindex="-1"></a><span class="cf">if</span> (u[i] <span class="sc">&lt;=</span> num<span class="sc">/</span>den) x[i] <span class="ot">&lt;-</span> y <span class="cf">else</span> {</span>
<span id="cb73-46"><a href="#cb73-46" tabindex="-1"></a>x[i] <span class="ot">&lt;-</span> xt</span>
<span id="cb73-47"><a href="#cb73-47" tabindex="-1"></a>k <span class="ot">&lt;-</span> k<span class="sc">+</span><span class="dv">1</span> <span class="co">#y is rejected</span></span>
<span id="cb73-48"><a href="#cb73-48" tabindex="-1"></a>}</span>
<span id="cb73-49"><a href="#cb73-49" tabindex="-1"></a>}</span>
<span id="cb73-50"><a href="#cb73-50" tabindex="-1"></a></span>
<span id="cb73-51"><a href="#cb73-51" tabindex="-1"></a>X[l,]<span class="ot">&lt;-</span>x</span>
<span id="cb73-52"><a href="#cb73-52" tabindex="-1"></a>}</span>
<span id="cb73-53"><a href="#cb73-53" tabindex="-1"></a></span>
<span id="cb73-54"><a href="#cb73-54" tabindex="-1"></a></span>
<span id="cb73-55"><a href="#cb73-55" tabindex="-1"></a></span>
<span id="cb73-56"><a href="#cb73-56" tabindex="-1"></a></span>
<span id="cb73-57"><a href="#cb73-57" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co">#number of chains to generate</span></span>
<span id="cb73-58"><a href="#cb73-58" tabindex="-1"></a></span>
<span id="cb73-59"><a href="#cb73-59" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co">#burn-in length</span></span></code></pre></div>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" tabindex="-1"></a><span class="co">#compute diagnostic statistics</span></span>
<span id="cb74-2"><a href="#cb74-2" tabindex="-1"></a>psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb74-3"><a href="#cb74-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb74-4"><a href="#cb74-4" tabindex="-1"></a>psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb74-5"><a href="#cb74-5" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">Gelman.Rubin</span>(psi))</span></code></pre></div>
<pre><code>## [1] 1.159489</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb76-2"><a href="#cb76-2" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, m)</span>
<span id="cb76-3"><a href="#cb76-3" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m)</span>
<span id="cb76-4"><a href="#cb76-4" tabindex="-1"></a>rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb76-5"><a href="#cb76-5" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb76-6"><a href="#cb76-6" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="hw8" class="section level1">
<h1>HW8</h1>
<div id="section-25" class="section level2">
<h2>1</h2>
<p>(1): </p>
<p>We notice that the Observed data likelihood is <span class="math display">\[ L(\lambda
|u_{i},v_{i})=\prod_{i=1}^{n}(e^{-\lambda u_{i}}-e^{-\lambda
v_{i}})\]</span>,So the optimal point have the equation <span class="math display">\[0=\frac{\partial log(L(\lambda
|u_{i},v_{i}))}{\partial \lambda} =-\sum_{i=1}^{n}\frac{u_{i}e^{-\lambda
u_{i}}-v_{i}e^{-\lambda v_{i}}}{e^{-\lambda u_{i}}-e^{-\lambda
v_{i}}}\]</span>. Then the Complete data likelihood is <span class="math display">\[L(\lambda
|u_{i},v_{i},X_{i})=\lambda^{n}\prod_{i=1}^{n}e^{-\lambda
X_{i}}1_{X_{i}\in (u_{i},v_{i})} \]</span>.We also have <span class="math display">\[\pi(X_{i}=x|u_{i},v_{i},\lambda_{k})=\frac{\lambda_{k}e^{-\lambda_{k}
x}}{e^{-\lambda_{k} u_{i}}-e^{-\lambda_{k} v_{i}}} 1_{x\in
(u_{i},v_{i})}\]</span>. </p>
<p>E-step:<span class="math display">\[E[X_{i}|u_{i},v_{i},\lambda_{k}]=\frac{1}{\lambda_{k}}
\frac{(1+\lambda_{k}u_{i})e^{-\lambda_{k}
u_{i}}-(1+\lambda_{k}v_{i})e^{-\lambda_{k} v_{i}}}{e^{-\lambda_{k}
u_{i}}-e^{-\lambda_{k} v_{i}}} \]</span></p>
<p>M-step:</p>
<p><span class="math display">\[\lambda_{k+1}
=\frac{n}{\sum_{i=1}^{n}E[X_{i}|u_{i},v_{i},\lambda_{k}]}\\
=\frac{n\lambda_{k}}{n+\lambda_{k}\sum_{i=1}^{n}
\frac{u_{i}e^{-\lambda_{k} u_{i}}-v_{i}e^{-\lambda_{k}
v_{i}}}{e^{-\lambda_{k} u_{i}}-e^{-\lambda_{k} v_{i}}}}\]</span></p>
<p>We replace <span class="math inline">\(\lambda_{k}\)</span>,<span class="math inline">\(\lambda_{k+1}\)</span> with <span class="math inline">\(\lambda\)</span> then we can see that the equation
above is equal to the equation that the MLE optimal satisfies.</p>
<p>Denote <span class="math display">\[h(\lambda)=\sum_{i=1}^{n}\frac{u_{i}e^{-\lambda_{k}
u_{i}}-v_{i}e^{-\lambda_{k} v_{i}}}{e^{-\lambda_{k}
u_{i}}-e^{-\lambda_{k} v_{i}}}\]</span>,we have <span class="math display">\[g&#39; (\lambda)=\frac{n^{2}-\lambda
nh&#39;(\lambda)-\lambda^{2}nh(\lambda)}{(n+\lambda
h(\lambda))^{2}}\]</span>.</p>
<p>Since <span class="math inline">\(\lambda=\lambda_{\infty}\)</span>
ensures that $h()=0 $ and$h’()(0,) $,we get <span class="math inline">\(g&#39;(\lambda_{\infty})\in(0,1)\)</span> which
shows <span class="math inline">\(\lambda_{k}\)</span> converges
linealy. </p>
<ol start="2" style="list-style-type: decimal">
<li></li>
</ol>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;stats4&quot;</span>)</span>
<span id="cb77-2"><a href="#cb77-2" tabindex="-1"></a>n<span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb77-3"><a href="#cb77-3" tabindex="-1"></a></span>
<span id="cb77-4"><a href="#cb77-4" tabindex="-1"></a>u<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">8</span>,<span class="dv">27</span>,<span class="dv">13</span>,<span class="dv">16</span>,<span class="dv">0</span>,<span class="dv">23</span>,<span class="dv">10</span>,<span class="dv">24</span>,<span class="dv">2</span>)</span>
<span id="cb77-5"><a href="#cb77-5" tabindex="-1"></a>v<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">9</span>,<span class="dv">28</span>,<span class="dv">14</span>,<span class="dv">17</span>,<span class="dv">1</span>,<span class="dv">24</span>,<span class="dv">11</span>,<span class="dv">25</span>,<span class="dv">3</span>)</span>
<span id="cb77-6"><a href="#cb77-6" tabindex="-1"></a></span>
<span id="cb77-7"><a href="#cb77-7" tabindex="-1"></a>mlogL <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">theta=</span><span class="dv">1</span>) {</span>
<span id="cb77-8"><a href="#cb77-8" tabindex="-1"></a><span class="co"># minus log-likelihood</span></span>
<span id="cb77-9"><a href="#cb77-9" tabindex="-1"></a><span class="fu">return</span>(<span class="sc">-</span>(<span class="fu">sum</span>(<span class="fu">log</span>(<span class="fu">exp</span>(<span class="sc">-</span>theta<span class="sc">*</span>u)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>theta<span class="sc">*</span>v)))))</span>
<span id="cb77-10"><a href="#cb77-10" tabindex="-1"></a>}</span>
<span id="cb77-11"><a href="#cb77-11" tabindex="-1"></a>fit<span class="ot">&lt;-</span><span class="fu">mle</span>(mlogL)</span>
<span id="cb77-12"><a href="#cb77-12" tabindex="-1"></a></span>
<span id="cb77-13"><a href="#cb77-13" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;the observed data likelihood estimate&quot;</span>,fit<span class="sc">@</span>coef,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## the observed data likelihood estimate 0.0719775</code></pre>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a>g<span class="ot">&lt;-</span><span class="cf">function</span>(x){</span>
<span id="cb79-2"><a href="#cb79-2" tabindex="-1"></a>  c<span class="ot">=</span><span class="fu">sum</span>((u<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">*</span>u)<span class="sc">-</span>v<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">*</span>v))<span class="sc">/</span>(<span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">*</span>u)<span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">*</span>v)))</span>
<span id="cb79-3"><a href="#cb79-3" tabindex="-1"></a>  <span class="fu">return</span>(x<span class="sc">*</span>n<span class="sc">/</span>(n<span class="sc">+</span>x<span class="sc">*</span>c))</span>
<span id="cb79-4"><a href="#cb79-4" tabindex="-1"></a>}</span>
<span id="cb79-5"><a href="#cb79-5" tabindex="-1"></a>error<span class="ot">&lt;-</span><span class="fl">1e-5</span></span>
<span id="cb79-6"><a href="#cb79-6" tabindex="-1"></a>a<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb79-7"><a href="#cb79-7" tabindex="-1"></a>lambda<span class="ot">=</span><span class="dv">1</span></span>
<span id="cb79-8"><a href="#cb79-8" tabindex="-1"></a></span>
<span id="cb79-9"><a href="#cb79-9" tabindex="-1"></a><span class="cf">while</span> (a<span class="sc">&gt;</span>error) {</span>
<span id="cb79-10"><a href="#cb79-10" tabindex="-1"></a>  a<span class="ot">&lt;-</span><span class="fu">abs</span>(lambda<span class="sc">-</span><span class="fu">g</span>(lambda))</span>
<span id="cb79-11"><a href="#cb79-11" tabindex="-1"></a>  lambda<span class="ot">&lt;-</span><span class="fu">g</span>(lambda)</span>
<span id="cb79-12"><a href="#cb79-12" tabindex="-1"></a>}</span>
<span id="cb79-13"><a href="#cb79-13" tabindex="-1"></a></span>
<span id="cb79-14"><a href="#cb79-14" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;the EM estimate&quot;</span>,lambda)</span></code></pre></div>
<pre><code>## the EM estimate 0.0719735</code></pre>
</div>
<div id="section-26" class="section level2">
<h2>11.8</h2>
<p>In the Morra game, the set of optimal strategies are not changed if a
constant is subtracted from every entry of the payoff matrix, or a
positive constant is multiplied times every entry of the payoff matrix.
However, the simplex algorithm may terminate at a different basic
feasible point (also optimal). Compute B &lt;- A + 2, find the solution
of game B, and verify that it is one of the extreme points
(11.12)–(11.15) of the original game A. Also find the value of game A
and game B</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" tabindex="-1"></a>solve.game <span class="ot">&lt;-</span> <span class="cf">function</span>(A) {</span>
<span id="cb81-2"><a href="#cb81-2" tabindex="-1"></a><span class="co">#solve the two player zero-sum game by simplex method</span></span>
<span id="cb81-3"><a href="#cb81-3" tabindex="-1"></a><span class="co">#optimize for player 1, then player 2</span></span>
<span id="cb81-4"><a href="#cb81-4" tabindex="-1"></a><span class="co">#maximize v subject to ...</span></span>
<span id="cb81-5"><a href="#cb81-5" tabindex="-1"></a><span class="co">#let x strategies 1:m, and put v as extra variable</span></span>
<span id="cb81-6"><a href="#cb81-6" tabindex="-1"></a><span class="co">#A1, the &lt;= constraints</span></span>
<span id="cb81-7"><a href="#cb81-7" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb81-8"><a href="#cb81-8" tabindex="-1"></a>min.A <span class="ot">&lt;-</span> <span class="fu">min</span>(A)</span>
<span id="cb81-9"><a href="#cb81-9" tabindex="-1"></a>A <span class="ot">&lt;-</span> A <span class="sc">-</span> min.A <span class="co">#so that v &gt;= 0</span></span>
<span id="cb81-10"><a href="#cb81-10" tabindex="-1"></a>max.A <span class="ot">&lt;-</span> <span class="fu">max</span>(A)</span>
<span id="cb81-11"><a href="#cb81-11" tabindex="-1"></a>A <span class="ot">&lt;-</span> A <span class="sc">/</span> <span class="fu">max</span>(A)</span>
<span id="cb81-12"><a href="#cb81-12" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">nrow</span>(A)</span>
<span id="cb81-13"><a href="#cb81-13" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(A)</span>
<span id="cb81-14"><a href="#cb81-14" tabindex="-1"></a>it <span class="ot">&lt;-</span> n<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb81-15"><a href="#cb81-15" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, m), <span class="dv">1</span>) <span class="co">#objective function</span></span>
<span id="cb81-16"><a href="#cb81-16" tabindex="-1"></a>A1 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">cbind</span>(<span class="fu">t</span>(A), <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, n)) <span class="co">#constraints &lt;=</span></span>
<span id="cb81-17"><a href="#cb81-17" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb81-18"><a href="#cb81-18" tabindex="-1"></a>A3 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, m), <span class="dv">0</span>))) <span class="co">#constraints sum(x)=1</span></span>
<span id="cb81-19"><a href="#cb81-19" tabindex="-1"></a>b3 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb81-20"><a href="#cb81-20" tabindex="-1"></a>sx <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a=</span>a, <span class="at">A1=</span>A1, <span class="at">b1=</span>b1, <span class="at">A3=</span>A3, <span class="at">b3=</span>b3,</span>
<span id="cb81-21"><a href="#cb81-21" tabindex="-1"></a><span class="at">maxi=</span><span class="cn">TRUE</span>, <span class="at">n.iter=</span>it)</span>
<span id="cb81-22"><a href="#cb81-22" tabindex="-1"></a><span class="co">#the ’solution’ is [x1,x2,...,xm | value of game]</span></span>
<span id="cb81-23"><a href="#cb81-23" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb81-24"><a href="#cb81-24" tabindex="-1"></a><span class="co">#minimize v subject to ...</span></span>
<span id="cb81-25"><a href="#cb81-25" tabindex="-1"></a><span class="co">#let y strategies 1:n, with v as extra variable</span></span>
<span id="cb81-26"><a href="#cb81-26" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>, n), <span class="dv">1</span>) <span class="co">#objective function</span></span>
<span id="cb81-27"><a href="#cb81-27" tabindex="-1"></a>A1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(A, <span class="fu">rep</span>(<span class="sc">-</span><span class="dv">1</span>, m)) <span class="co">#constraints &lt;=</span></span>
<span id="cb81-28"><a href="#cb81-28" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, m)</span>
<span id="cb81-29"><a href="#cb81-29" tabindex="-1"></a>A3 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">as.matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, n), <span class="dv">0</span>))) <span class="co">#constraints sum(y)=1</span></span>
<span id="cb81-30"><a href="#cb81-30" tabindex="-1"></a>b3 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb81-31"><a href="#cb81-31" tabindex="-1"></a>sy <span class="ot">&lt;-</span> <span class="fu">simplex</span>(<span class="at">a=</span>a, <span class="at">A1=</span>A1, <span class="at">b1=</span>b1, <span class="at">A3=</span>A3, <span class="at">b3=</span>b3,</span>
<span id="cb81-32"><a href="#cb81-32" tabindex="-1"></a><span class="at">maxi=</span><span class="cn">FALSE</span>, <span class="at">n.iter=</span>it)</span>
<span id="cb81-33"><a href="#cb81-33" tabindex="-1"></a>soln <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;A&quot;</span> <span class="ot">=</span> A <span class="sc">*</span> max.A <span class="sc">+</span> min.A,</span>
<span id="cb81-34"><a href="#cb81-34" tabindex="-1"></a><span class="st">&quot;x&quot;</span> <span class="ot">=</span> sx<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>m],</span>
<span id="cb81-35"><a href="#cb81-35" tabindex="-1"></a><span class="st">&quot;y&quot;</span> <span class="ot">=</span> sy<span class="sc">$</span>soln[<span class="dv">1</span><span class="sc">:</span>n],</span>
<span id="cb81-36"><a href="#cb81-36" tabindex="-1"></a><span class="st">&quot;v&quot;</span> <span class="ot">=</span> sx<span class="sc">$</span>soln[m<span class="sc">+</span><span class="dv">1</span>] <span class="sc">*</span> max.A <span class="sc">+</span> min.A)</span>
<span id="cb81-37"><a href="#cb81-37" tabindex="-1"></a>soln</span>
<span id="cb81-38"><a href="#cb81-38" tabindex="-1"></a>}</span>
<span id="cb81-39"><a href="#cb81-39" tabindex="-1"></a></span>
<span id="cb81-40"><a href="#cb81-40" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>( <span class="dv">0</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb81-41"><a href="#cb81-41" tabindex="-1"></a><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb81-42"><a href="#cb81-42" tabindex="-1"></a><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,</span>
<span id="cb81-43"><a href="#cb81-43" tabindex="-1"></a><span class="sc">-</span><span class="dv">3</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,</span>
<span id="cb81-44"><a href="#cb81-44" tabindex="-1"></a><span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,</span>
<span id="cb81-45"><a href="#cb81-45" tabindex="-1"></a><span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">5</span>,</span>
<span id="cb81-46"><a href="#cb81-46" tabindex="-1"></a><span class="sc">-</span><span class="dv">4</span>,<span class="sc">-</span><span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">6</span>,</span>
<span id="cb81-47"><a href="#cb81-47" tabindex="-1"></a><span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">6</span>,</span>
<span id="cb81-48"><a href="#cb81-48" tabindex="-1"></a><span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">5</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="dv">0</span>), <span class="dv">9</span>, <span class="dv">9</span>)</span>
<span id="cb81-49"><a href="#cb81-49" tabindex="-1"></a></span>
<span id="cb81-50"><a href="#cb81-50" tabindex="-1"></a><span class="fu">library</span>(boot) <span class="co">#needed for simplex function</span></span>
<span id="cb81-51"><a href="#cb81-51" tabindex="-1"></a></span>
<span id="cb81-52"><a href="#cb81-52" tabindex="-1"></a>B<span class="ot">&lt;-</span>A<span class="sc">+</span><span class="dv">2</span></span>
<span id="cb81-53"><a href="#cb81-53" tabindex="-1"></a></span>
<span id="cb81-54"><a href="#cb81-54" tabindex="-1"></a>s1<span class="ot">&lt;-</span><span class="fu">solve.game</span>(A)</span>
<span id="cb81-55"><a href="#cb81-55" tabindex="-1"></a>s2<span class="ot">&lt;-</span><span class="fu">solve.game</span>(B)</span></code></pre></div>
<p>the solution of game B</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a> <span class="fu">round</span>(<span class="fu">cbind</span>(s2<span class="sc">$</span>x, s2<span class="sc">$</span>y), <span class="dv">7</span>)</span></code></pre></div>
<pre><code>##         [,1]      [,2]
## x1 0.0000000 0.0000000
## x2 0.0000000 0.0000000
## x3 0.4098361 0.4098361
## x4 0.0000000 0.0000000
## x5 0.3278689 0.3278689
## x6 0.0000000 0.0000000
## x7 0.2622951 0.2622951
## x8 0.0000000 0.0000000
## x9 0.0000000 0.0000000</code></pre>
<p>So it is one of the extreme points (11.12)–(11.15) of the original
game A.</p>
<p>value of game A and game B</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;value of game A:&quot;</span>,s1<span class="sc">$</span>v,<span class="st">&quot;</span><span class="sc">\t</span><span class="st"> value of game B:&quot;</span>,s2<span class="sc">$</span>v)</span></code></pre></div>
<pre><code>## value of game A: 0    value of game B: 2</code></pre>
</div>
</div>
<div id="hw9" class="section level1">
<h1>HW9</h1>
<div id="section-27" class="section level2">
<h2>2.1.3 4</h2>
<p>Why do you need to use unlist() to convert a list to an atomic
vector? Why doesn’t as.vector() work?</p>
<p>Because as.vector will do the function for every column,here is an
example.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>),<span class="fu">c</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]))</span>
<span id="cb86-2"><a href="#cb86-2" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="fu">as.vector</span>(a)</span>
<span id="cb86-3"><a href="#cb86-3" tabindex="-1"></a>c<span class="ot">&lt;-</span><span class="fu">unlist</span>(a)</span>
<span id="cb86-4"><a href="#cb86-4" tabindex="-1"></a><span class="fu">print</span>(b)</span></code></pre></div>
<pre><code>## [[1]]
## [1] 1 1 3
## 
## [[2]]
## [1] &quot;a&quot; &quot;b&quot; &quot;c&quot;</code></pre>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" tabindex="-1"></a><span class="fu">print</span>(c)</span></code></pre></div>
<pre><code>## [1] &quot;1&quot; &quot;1&quot; &quot;3&quot; &quot;a&quot; &quot;b&quot; &quot;c&quot;</code></pre>
</div>
<div id="section-28" class="section level2">
<h2>2.3.1 1</h2>
<p>What does dim() return when applied to a vector?</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">numeric</span>(<span class="dv">10</span>)</span>
<span id="cb90-2"><a href="#cb90-2" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">dim</span>(a))</span></code></pre></div>
<pre><code>## NULL</code></pre>
<p>it will return NULL.</p>
</div>
<div id="section-29" class="section level2">
<h2>2.3.1 2</h2>
<p>If is.matrix(x) is TRUE, what will is.array(x) return?</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" tabindex="-1"></a>A<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>,<span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb92-2"><a href="#cb92-2" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">is.matrix</span>(A))</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">is.array</span>(A))</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>It will return true.</p>
</div>
<div id="section-30" class="section level2">
<h2>2.4.5 2</h2>
<p>What does as.matrix() do when applied to a data frame with columns of
different types?</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span></span>
<span id="cb96-2"><a href="#cb96-2" tabindex="-1"></a>b<span class="ot">&lt;-</span>letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb96-3"><a href="#cb96-3" tabindex="-1"></a>C<span class="ot">&lt;-</span><span class="fu">data.frame</span>(a,b)</span>
<span id="cb96-4"><a href="#cb96-4" tabindex="-1"></a>D<span class="ot">&lt;-</span><span class="fu">as.matrix</span>(C)</span>
<span id="cb96-5"><a href="#cb96-5" tabindex="-1"></a><span class="fu">print</span>(D)</span></code></pre></div>
<pre><code>##      a   b  
## [1,] &quot;1&quot; &quot;a&quot;
## [2,] &quot;2&quot; &quot;b&quot;
## [3,] &quot;3&quot; &quot;c&quot;</code></pre>
<p>It will construct the matrix with the type of the highest type of the
columns.</p>
</div>
<div id="section-31" class="section level2">
<h2>2.4.5 3</h2>
<p>Can you have a data frame with 0 rows? What about 0 columns?</p>
<p>Both of the question is yes.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" tabindex="-1"></a>m<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="at">ncol =</span> <span class="dv">0</span>,<span class="at">nrow =</span> <span class="dv">0</span>)</span>
<span id="cb98-2"><a href="#cb98-2" tabindex="-1"></a></span>
<span id="cb98-3"><a href="#cb98-3" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="fu">data.frame</span>(m)</span>
<span id="cb98-4"><a href="#cb98-4" tabindex="-1"></a></span>
<span id="cb98-5"><a href="#cb98-5" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">dim</span>(d))</span></code></pre></div>
<pre><code>## [1] 0 0</code></pre>
</div>
<div id="exercise-2" class="section level2">
<h2>exercise 2</h2>
<p>The function below scales a vector so it falls in the range [0, 1].
How would you apply it to every column of a data frame? How would you
apply it to every numeric column in a data frame?</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" tabindex="-1"></a>scale01 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb100-2"><a href="#cb100-2" tabindex="-1"></a>rng <span class="ot">&lt;-</span> <span class="fu">range</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb100-3"><a href="#cb100-3" tabindex="-1"></a>(x <span class="sc">-</span> rng[<span class="dv">1</span>]) <span class="sc">/</span> (rng[<span class="dv">2</span>] <span class="sc">-</span> rng[<span class="dv">1</span>])</span>
<span id="cb100-4"><a href="#cb100-4" tabindex="-1"></a>}</span>
<span id="cb100-5"><a href="#cb100-5" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,<span class="at">nrow =</span> <span class="dv">5</span>)</span>
<span id="cb100-6"><a href="#cb100-6" tabindex="-1"></a></span>
<span id="cb100-7"><a href="#cb100-7" tabindex="-1"></a>b<span class="ot">&lt;-</span><span class="fu">apply</span>(a, <span class="dv">2</span>, scale01)</span>
<span id="cb100-8"><a href="#cb100-8" tabindex="-1"></a><span class="fu">print</span>(b)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,] 0.00 0.00 0.00 0.00
## [2,] 0.25 0.25 0.25 0.25
## [3,] 0.50 0.50 0.50 0.50
## [4,] 0.75 0.75 0.75 0.75
## [5,] 1.00 1.00 1.00 1.00</code></pre>
</div>
<div id="exercise-1" class="section level2">
<h2>exercise 1</h2>
<ol style="list-style-type: decimal">
<li>Use vapply() to:</li>
</ol>
<!-- -->
<ol style="list-style-type: lower-alpha">
<li>Compute the standard deviation of every column in a numeric data
frame.</li>
<li>Compute the standard deviation of every numeric column in a mixed
data frame. (Hint: you’ll need to use vapply() twice.)</li>
</ol>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="fu">rnorm</span>(<span class="dv">10</span>)</span>
<span id="cb102-2"><a href="#cb102-2" tabindex="-1"></a>b<span class="ot">&lt;-</span>letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span>
<span id="cb102-3"><a href="#cb102-3" tabindex="-1"></a>c<span class="ot">&lt;-</span><span class="fu">rexp</span>(<span class="dv">10</span>)</span>
<span id="cb102-4"><a href="#cb102-4" tabindex="-1"></a>A<span class="ot">&lt;-</span><span class="fu">data.frame</span>(a,c)</span>
<span id="cb102-5"><a href="#cb102-5" tabindex="-1"></a>B<span class="ot">&lt;-</span><span class="fu">data.frame</span>(a,b,c)</span>
<span id="cb102-6"><a href="#cb102-6" tabindex="-1"></a><span class="fu">vapply</span>(A,<span class="at">FUN=</span>sd,<span class="at">FUN.VALUE =</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>##         a         c 
## 0.9852858 0.7720475</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="fu">vapply</span>(B, sd, <span class="at">FUN.VALUE =</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## Warning in var(if (is.vector(x) || is.factor(x)) x else as.double(x), na.rm =
## na.rm): NAs introduced by coercion</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" tabindex="-1"></a>d[<span class="sc">!</span><span class="fu">is.na</span>(d)]</span></code></pre></div>
<pre><code>##         a         c 
## 0.9852858 0.7720475</code></pre>
</div>
<div id="section-32" class="section level2">
<h2>2</h2>
<ol start="2" style="list-style-type: decimal">
<li>Consider Exercise 9.8 (pages 278, Statistical Computing with R).
(Hint: Refer to the first example of Case studies section) • Write an R
function. • Write an Rcpp function. • Compare the computation time of
the two functions with the function “microbenchmark”</li>
</ol>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;Rcpp&quot;</span>)</span>
<span id="cb108-2"><a href="#cb108-2" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;microbenchmark&quot;</span>)</span>
<span id="cb108-3"><a href="#cb108-3" tabindex="-1"></a></span>
<span id="cb108-4"><a href="#cb108-4" tabindex="-1"></a>a<span class="ot">=</span><span class="fl">0.5</span></span>
<span id="cb108-5"><a href="#cb108-5" tabindex="-1"></a>b<span class="ot">=</span><span class="fl">0.5</span></span>
<span id="cb108-6"><a href="#cb108-6" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">20</span></span>
<span id="cb108-7"><a href="#cb108-7" tabindex="-1"></a></span>
<span id="cb108-8"><a href="#cb108-8" tabindex="-1"></a>gibbsR <span class="ot">&lt;-</span> <span class="cf">function</span>(N, thin) {</span>
<span id="cb108-9"><a href="#cb108-9" tabindex="-1"></a>  mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> N, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb108-10"><a href="#cb108-10" tabindex="-1"></a>  x <span class="ot">&lt;-</span> y <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb108-11"><a href="#cb108-11" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb108-12"><a href="#cb108-12" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>thin) {</span>
<span id="cb108-13"><a href="#cb108-13" tabindex="-1"></a>      x <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>,n,y)</span>
<span id="cb108-14"><a href="#cb108-14" tabindex="-1"></a>      y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>,x<span class="sc">+</span>a,n<span class="sc">+</span>b<span class="sc">-</span>x)</span>
<span id="cb108-15"><a href="#cb108-15" tabindex="-1"></a>    }</span>
<span id="cb108-16"><a href="#cb108-16" tabindex="-1"></a>    mat[i, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb108-17"><a href="#cb108-17" tabindex="-1"></a>  }</span>
<span id="cb108-18"><a href="#cb108-18" tabindex="-1"></a>  mat</span>
<span id="cb108-19"><a href="#cb108-19" tabindex="-1"></a>}</span>
<span id="cb108-20"><a href="#cb108-20" tabindex="-1"></a></span>
<span id="cb108-21"><a href="#cb108-21" tabindex="-1"></a><span class="fu">cppFunction</span>(<span class="st">&#39;#include &lt;Rcpp.h&gt;</span></span>
<span id="cb108-22"><a href="#cb108-22" tabindex="-1"></a><span class="st">using namespace Rcpp;</span></span>
<span id="cb108-23"><a href="#cb108-23" tabindex="-1"></a><span class="st">// [[Rcpp::export]]</span></span>
<span id="cb108-24"><a href="#cb108-24" tabindex="-1"></a><span class="st">NumericMatrix gibbsC(int N, int thin) {</span></span>
<span id="cb108-25"><a href="#cb108-25" tabindex="-1"></a><span class="st">  NumericMatrix mat(N, 2);</span></span>
<span id="cb108-26"><a href="#cb108-26" tabindex="-1"></a><span class="st">  double x = 0, y = 0,a=0.5,b=0.5,n=20;</span></span>
<span id="cb108-27"><a href="#cb108-27" tabindex="-1"></a><span class="st">  for(int i = 0; i &lt; N; i++) {</span></span>
<span id="cb108-28"><a href="#cb108-28" tabindex="-1"></a><span class="st">    for(int j = 0; j &lt; thin; j++) {</span></span>
<span id="cb108-29"><a href="#cb108-29" tabindex="-1"></a><span class="st">      x = rbinom(1,n,y)[0];</span></span>
<span id="cb108-30"><a href="#cb108-30" tabindex="-1"></a><span class="st">      y = rbeta(1,x+a,n+b-x)[0];</span></span>
<span id="cb108-31"><a href="#cb108-31" tabindex="-1"></a><span class="st">    }</span></span>
<span id="cb108-32"><a href="#cb108-32" tabindex="-1"></a><span class="st">    mat(i, 0) = x;</span></span>
<span id="cb108-33"><a href="#cb108-33" tabindex="-1"></a><span class="st">    mat(i, 1) = y;</span></span>
<span id="cb108-34"><a href="#cb108-34" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb108-35"><a href="#cb108-35" tabindex="-1"></a><span class="st">  return(mat);</span></span>
<span id="cb108-36"><a href="#cb108-36" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb108-37"><a href="#cb108-37" tabindex="-1"></a><span class="st">&#39;</span>)</span></code></pre></div>
<pre><code>## Warning: No function found for Rcpp::export attribute at file4fe4247733d.cpp:5</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="at">gibbR=</span><span class="fu">gibbsR</span>(<span class="dv">100</span>,<span class="dv">10</span>),</span>
<span id="cb110-2"><a href="#cb110-2" tabindex="-1"></a><span class="at">gibbC=</span><span class="fu">gibbsC</span>(<span class="dv">100</span>,<span class="dv">10</span>))</span>
<span id="cb110-3"><a href="#cb110-3" tabindex="-1"></a><span class="fu">summary</span>(ts)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##    expr        lq    median       uq
## 1 gibbR 3060.1010 3127.9015 3220.752
## 2 gibbC  337.4015  339.8515  347.202</code></pre>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
